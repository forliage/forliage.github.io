<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åˆ†ç±»æ–‡ç« </title>
    <link rel="stylesheet" href="style.css"> <!-- Assuming a shared style.css -->
    <link rel="stylesheet" href="modal.css">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FPDBQB4LZD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-FPDBQB4LZD');
    </script>
</head>
<body>
    <audio id="bg-music" src="music.mp3" loop></audio>
    <button id="style-toggle-btn" title="åˆ‡æ¢æ§ä»¶æ ·å¼">ğŸ¨</button>
    <button id="music-toggle" class="music-control">â™ª</button>
    <label class="dark-mode-control liquid-toggle">
        <input type="checkbox" id="dark-mode-toggle">
        <span class="knob"></span>
    </label>
    <header>
        <h1><span id="category-name"></span>ä¸‹çš„æ–‡ç« </h1>
        <nav>
            <ul>
                <li><a href="index.html">é¦–é¡µ</a></li>
                <li><a href="posts.html">æ–‡ç« </a></li>
                <li><a href="about.html">å…³äº</a></li>
                <li><a href="category.html?category=æŠ€æœ¯æ–‡ç« ">æŠ€æœ¯æ–‡ç« </a></li>
                <li><a href="category.html?category=ç”Ÿæ´»éšç¬”">ç”Ÿæ´»éšç¬”</a></li>
                <li><a href="category.html?category=å­¦ä¹ ç¬”è®°">å­¦ä¹ ç¬”è®°</a></li>
                <li><a href="category.html?category=å¿ƒæƒ…æ—¥è®°">å¿ƒæƒ…æ—¥è®°</a></li>
                <li><a href="#" id="about-me-btn">ABOUT ME</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        <main>
            <!-- Container for posts in non-learning categories -->
            <div id="article-list">
                <!-- Articles will be listed here by JavaScript -->
            </div>
            <!-- New container for learning notes, hidden by default -->
            <div id="learning-notes-content" style="display: none;">
                <div id="search-container">
                    <input type="search" id="search-input" placeholder="åœ¨å­¦ä¹ ç¬”è®°ä¸­æœç´¢æ ‡é¢˜...">
                    <div class="siri-wave"></div>
                </div>
                <div id="course-cards-container">
                    <!-- Course cards will be generated here -->
                </div>
            </div>
            <!-- New container for technical articles, hidden by default -->
            <div id="technical-articles-content" style="display: none;">
                <div id="search-container-tech">
                    <input type="search" id="search-input-tech" placeholder="åœ¨æŠ€æœ¯æ–‡ç« ä¸­æœç´¢æ ‡é¢˜...">
                    <div class="siri-wave"></div>
                </div>
                <div id="technical-cards-container">
                    <!-- Technical article cards will be generated here -->
                </div>
            </div>
        </main>
    </div>
    <footer>
        <p>Â© 2025 æˆ‘çš„åšå®¢</p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const categoryNameElement = document.getElementById('category-name');
            const params = new URLSearchParams(window.location.search);
            const category = params.get('category');

            if (category) {
                categoryNameElement.textContent = category;
                document.title = category + " - åˆ†ç±»æ–‡ç« ";
                fetchPostsForCategory(category);
            } else {
                const articleListElement = document.getElementById('article-list');
                categoryNameElement.textContent = 'æœªæŒ‡å®šåˆ†ç±»';
                articleListElement.innerHTML = '<p>æ²¡æœ‰æŒ‡å®šåˆ†ç±»ï¼Œæ— æ³•åŠ è½½æ–‡ç« ã€‚</p>';
            }
        });

        async function fetchPostsForCategory(category) {
            const articleListElement = document.getElementById('article-list');
            const learningNotesContainer = document.getElementById('learning-notes-content');
            const courseCardsContainer = document.getElementById('course-cards-container');
            const searchInput = document.getElementById('search-input');
            const technicalArticlesContainer = document.getElementById('technical-articles-content');
            const technicalCardsContainer = document.getElementById('technical-cards-container');
            const searchInputTech = document.getElementById('search-input-tech');

            let allPosts;
            try {
                const res = await fetch('./posts.json');
                if (!res.ok) throw new Error(res.statusText);
                allPosts = await res.json();
            } catch (err) {
                if (window.postsData) {
                    allPosts = window.postsData;
                } else {
                    articleListElement.innerHTML = '<p>åŠ è½½æ–‡ç« åˆ—è¡¨æ—¶å‘ç”Ÿé”™è¯¯ã€‚</p>';
                    console.error(err);
                    return;
                }
            }

            const postsForCategory = allPosts.filter(p => p.category === category);

            if (postsForCategory.length === 0) {
                let container;
                if (category === 'å­¦ä¹ ç¬”è®°') {
                    container = courseCardsContainer;
                    learningNotesContainer.style.display = 'block';
                    articleListElement.style.display = 'none';
                    technicalArticlesContainer.style.display = 'none';
                } else if (category === 'æŠ€æœ¯æ–‡ç« ') {
                    container = courseCardsContainer;
                    learningNotesContainer.style.display = 'block';
                    articleListElement.style.display = 'none';
                    technicalArticlesContainer.style.display = 'none';
                } else {
                    container = articleListElement;
                }
                container.innerHTML = `<p>â€œ${category}â€åˆ†ç±»ä¸‹æš‚æ— æ–‡ç« ã€‚</p>`;
                return;
            }

            if (category === 'å­¦ä¹ ç¬”è®°') {
                learningNotesContainer.style.display = 'block';
                articleListElement.style.display = 'none';
                technicalArticlesContainer.style.display = 'none';
                renderLearningNotes(postsForCategory, courseCardsContainer);

                searchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    const filteredPosts = postsForCategory.filter(post =>
                        post.title.toLowerCase().includes(searchTerm)
                    );
                    renderLearningNotes(filteredPosts, courseCardsContainer);
                });
            } else if (category === 'æŠ€æœ¯æ–‡ç« ') {
                learningNotesContainer.style.display = 'block';
                articleListElement.style.display = 'none';
                technicalArticlesContainer.style.display = 'none';
                renderTechnicalArticles(postsForCategory, courseCardsContainer);

                searchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    const filteredPosts = postsForCategory.filter(post =>
                        post.title.toLowerCase().includes(searchTerm)
                    );
                    renderTechnicalArticles(filteredPosts, courseCardsContainer);
                });
            } else {
                articleListElement.innerHTML = '';
                postsForCategory.forEach(post => {
                    const article = document.createElement('article');
                    article.innerHTML = `
                        <h3><a class="post-link" href="${post.path}">${post.title}</a></h3>
                        <p>${post.abstract}</p>
                    `;
                    articleListElement.appendChild(article);
                });
            }
        }

        function renderLearningNotes(posts, container) {
            const courseIntroductions = {
                'ADS è¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦é«˜çº§æ•°æ®ç»“æ„ä¸ç®—æ³•(ADS)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'CUDA å­¦ä¹ ç¬”è®°': 'CUDAå­¦ä¹ ç¬”è®°,åŸºäºNVIDIAå®˜ç½‘æ‰‹å†Œ',
                'è®¡ç®—æœºåŠ¨ç”»è¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦ç ”ç©¶ç”Ÿè¯¾ç¨‹è®¡ç®—æœºåŠ¨ç”»çš„ç¬”è®°',
                'DIPå›¾åƒä¿¡æ¯å¤„ç†è¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦å›¾åƒä¿¡æ¯å¤„ç†(DIP)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'è®¡ç®—æœºç»„æˆè¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦è®¡ç®—æœºç»„æˆ(CO)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'x86æ±‡ç¼–è¯­è¨€':'ç»å­¦ä¹ æµ™æ±Ÿå¤§å­¦æ±‡ç¼–è¯­è¨€(ASM)è¯¾ç¨‹åæ•´ç†çš„è‡ªå·±çš„ä¸€äº›ç†è§£',
                'è®¡ç®—æœºä½“ç³»ç»“æ„è¯¾ç¨‹ç¬”è®°':'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦è®¡ç®—æœºä½“ç³»ç»“æ„(CA)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'æ•°æ®åº“ç³»ç»Ÿè¯¾ç¨‹ç¬”è®°':'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦æ•°æ®åº“ç³»ç»Ÿ(DB)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'æ•°å€¼åˆ†æè¯¾ç¨‹ç¬”è®°':'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦æ•°å€¼åˆ†æ(NA)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'è®¡ç®—æœºå›¾å½¢å­¦è¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦è®¡ç®—æœºå›¾å½¢å­¦(CG)è¯¾ç¨‹çš„ç¬”è®°ï¼Œç»ä¿®ç¼®åé‡æ–°ä¸Šä¼ ',
                'çº¿æ€§ä»£æ•°(ä»ç®—å­è§’åº¦ç†è§£)': 'ä»ç®—å­è§’åº¦é‡æ–°ç†è§£çº¿æ€§ä»£æ•°ï¼Œé€‚åˆè¿›é˜¶ç†è§£çº¿æ€§ä»£æ•°çš„æœ‹å‹ï¼Œå‚è€ƒã€Šçº¿æ€§ä»£æ•°åº”è¯¥è¿™æ ·å­¦ã€‹',
                'è®¡ç®—ç†è®ºè¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦è®¡ç®—ç†è®ºè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬å­¦æœŸå°†æŒç»­æ›´æ–°',
                'æ“ä½œç³»ç»Ÿè¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦æ“ä½œç³»ç»Ÿè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬å­¦æœŸå°†æŒç»­æ›´æ–°',
                'è®¡ç®—æœºç½‘ç»œè¯¾ç¨‹ç¬”è®°': 'è¿™é‡Œæ˜¯æµ™æ±Ÿå¤§å­¦è®¡ç®—æœºç½‘ç»œè¯¾ç¨‹çš„ç¬”è®°ï¼Œæœ¬å­¦æœŸå°†æŒç»­æ›´æ–°(ç”±jinkykyæä¾›)',
                'å…¶ä»–': 'ä¸€äº›å°šæœªåˆ†ç±»çš„å­¦ä¹ ç¬”è®°ã€‚'
            };

            const groupedByCourse = posts.reduce((acc, post) => {
                let courseName = 'å…¶ä»–';
                const lowerTitle = post.title.toLowerCase();
                if (lowerTitle.startsWith('ads')) {
                    courseName = 'ADS è¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('cuda')) {
                    courseName = 'CUDA å­¦ä¹ ç¬”è®°';
                } else if (lowerTitle.startsWith('è®¡ç®—æœºåŠ¨ç”»')) {
                    courseName = 'è®¡ç®—æœºåŠ¨ç”»è¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('DIP') || lowerTitle.startsWith('å›¾åƒä¿¡æ¯å¤„ç†') || lowerTitle.startsWith('dip')) {
                    courseName = 'DIPå›¾åƒä¿¡æ¯å¤„ç†è¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('CO') || lowerTitle.startsWith('è®¡ç®—æœºç»„æˆ')) {
                    courseName = 'è®¡ç®—æœºç»„æˆè¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('asm') || lowerTitle.startsWith('x86æ±‡ç¼–')) {
                    courseName = 'x86æ±‡ç¼–è¯­è¨€';
                } else if (lowerTitle.startsWith('è®¡ç®—æœºä½“ç³»ç»“æ„')) {
                    courseName = 'è®¡ç®—æœºä½“ç³»ç»“æ„è¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('æ•°æ®åº“ç³»ç»Ÿ')) {
                    courseName = 'æ•°æ®åº“ç³»ç»Ÿè¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('æ•°å€¼åˆ†æ')) {
                    courseName = 'æ•°å€¼åˆ†æè¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('è®¡ç®—æœºå›¾å½¢å­¦')) {
                    courseName = 'è®¡ç®—æœºå›¾å½¢å­¦è¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('çº¿æ€§ä»£æ•°')) {
                    courseName = 'çº¿æ€§ä»£æ•°(ä»ç®—å­è§’åº¦ç†è§£)';
                } else if (lowerTitle.startsWith('è®¡ç®—ç†è®º')) {
                    courseName = 'è®¡ç®—ç†è®ºè¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('æ“ä½œç³»ç»Ÿ')) {
                    courseName = 'æ“ä½œç³»ç»Ÿè¯¾ç¨‹ç¬”è®°';
                } else if (lowerTitle.startsWith('è®¡ç®—æœºç½‘ç»œ')) {
                    courseName = 'è®¡ç®—æœºç½‘ç»œè¯¾ç¨‹ç¬”è®°';
                }
                
                if (!acc[courseName]) {
                    acc[courseName] = [];
                }
                acc[courseName].push(post);
                return acc;
            }, {});

            container.innerHTML = '';
            
            if (posts.length === 0) {
                container.innerHTML = '<p style="text-align: center;">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç¬”è®°ã€‚</p>';
                return;
            }

            let isPink = true;
            const courseNames = Object.keys(groupedByCourse).sort();

            for (const courseName of courseNames) {
                const coursePosts = groupedByCourse[courseName];
                
                const card = document.createElement('div');
                card.className = `course-card ${isPink ? 'course-card-pink' : 'course-card-white'}`;
                
                const introText = courseIntroductions[courseName] || 'æš‚æ— ç®€ä»‹ã€‚';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${courseName}</h3>
                        <p class="card-intro">${introText}</p>
                    </div>
                    <div class="card-body" style="display: none;">
                        <ul>
                            ${coursePosts.sort((a,b) => a.title.localeCompare(b.title)).map(post => `<li><a class="post-link" href="${post.path}">${post.title}</a></li>`).join('')}
                        </ul>
                    </div>
                `;
                
                container.appendChild(card);
                
                const header = card.querySelector('.card-header');
                header.addEventListener('click', () => {
                    const body = card.querySelector('.card-body');
                    card.classList.toggle('expanded');
                    body.style.display = card.classList.contains('expanded') ? 'block' : 'none';
                });
                
                isPink = !isPink;
            }
        }

        function renderTechnicalArticles(posts, container) {
            const technicalIntroductions = {
                'æŠ€æœ¯æ‹“å±•': 'ä¸€äº›æŠ€æœ¯æ–¹é¢çš„æ€è€ƒ',
                'æ•°å­¦': 'å¶å°”å­¦ä¹ ä¸€ä¸‹æ•°å­¦',
                'ç®—æ³•': 'å­¦ä¹ ç®—æ³•',
                'è®ºæ–‡è§£æ': 'è¯»è®ºæ–‡,å†™ä¸€äº›æƒ³æ³•å’Œè§£é‡Š',
                'å…¶ä»–': 'ä¸€äº›å°šæœªåˆ†ç±»çš„æŠ€æœ¯æ–‡ç« ã€‚'
            };

            const groupedBySubCategory = posts.reduce((acc, post) => {
                let subCategoryName = 'å…¶ä»–';
                const lowerTitle = post.title.toLowerCase();
                if (lowerTitle.startsWith('æŠ€æœ¯æ‹“å±•')) {
                    subCategoryName = 'æŠ€æœ¯æ‹“å±•';
                } else if (lowerTitle.startsWith('æ•°å­¦')) {
                    subCategoryName = 'æ•°å­¦';
                } else if (lowerTitle.startsWith('ç®—æ³•')) {
                    subCategoryName = 'ç®—æ³•';
                } else if (lowerTitle.startsWith('è®ºæ–‡è§£æ')) {
                    subCategoryName = 'è®ºæ–‡è§£æ';
                }
                
                if (!acc[subCategoryName]) {
                    acc[subCategoryName] = [];
                }
                acc[subCategoryName].push(post);
                return acc;
            }, {});

            container.innerHTML = '';
            
            if (posts.length === 0) {
                container.innerHTML = '<p style="text-align: center;">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ–‡ç« ã€‚</p>';
                return;
            }

            let isPink = true;
            const subCategoryNames = Object.keys(groupedBySubCategory).sort();

            for (const subCategoryName of subCategoryNames) {
                const subCategoryPosts = groupedBySubCategory[subCategoryName];
                
                const card = document.createElement('div');
                card.className = `course-card ${isPink ? 'course-card-pink' : 'course-card-white'}`;
                
                const introText = technicalIntroductions[subCategoryName] || 'æš‚æ— ç®€ä»‹ã€‚';
                card.innerHTML = `
                    <div class="card-header">
                        <h3>${subCategoryName}</h3>
                        <p class="card-intro">${introText}</p>
                    </div>
                    <div class="card-body" style="display: none;">
                        <ul>
                            ${subCategoryPosts.sort((a,b) => a.title.localeCompare(b.title)).map(post => `<li><a class="post-link" href="${post.path}">${post.title}</a></li>`).join('')}
                        </ul>
                    </div>
                `;
                
                container.appendChild(card);
                
                const header = card.querySelector('.card-header');
                header.addEventListener('click', () => {
                    const body = card.querySelector('.card-body');
                    card.classList.toggle('expanded');
                    body.style.display = card.classList.contains('expanded') ? 'block' : 'none';
                });
                
                isPink = !isPink;
            }
        }
    </script>
    <script src="posts.js"></script>
    <div class="dock">
        <a href="https://forliage.github.io/index.html" data-icon="ğŸ ">ğŸ </a>
        <a href="https://forliage.github.io/posts.html" data-icon="ğŸ“š">ğŸ“š</a>
        <a href="https://forliage.github.io/about.html" data-icon="ğŸ‘¤">ğŸ‘¤</a>
    </div>
    <script src="script.js"></script>
    <!-- The Modal -->
    <div id="about-me-modal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>About Me</h2>
        <p>This is forliage, an undergraduate student of computer science and technology at Zhejiang University.</p>
        <p><strong>Motto:</strong> People always say that time heals all wounds, but I don't believe that. Time doen't heal the pain, it just makes us get used to pain. When you lose someone, you don't really forget them; you just learn how to live on without them.</p>
        <p><strong>Interests:</strong> Computer Graphics, Computer Version, Computer Animation, HPC, AIGC</p>
        <p><strong>Favorite Movie:</strong> The Shawshank Redemption, Dead Poets Society, Zootopia</p>
        <p><strong>Favorite Music:</strong> Blank Space, Sorega Daiji, Counting Stars, Whataya Want from Me</p>
        <p><strong>Contact Information:</strong>masterforliage@gmail.com</p>
        <hr>
        <h3>è®¢é˜…æˆ‘çš„åšå®¢</h3>
        <p>è®¢é˜…åŠŸèƒ½æ­£åœ¨å»ºè®¾ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼</p>
      </div>
    </div>
    <script src="modal.js"></script>
    <script src="trail.js"></script>
</body>
</html>