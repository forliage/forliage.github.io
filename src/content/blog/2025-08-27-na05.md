---
title: "数值分析05:线性系统迭代法及其收敛性理论"
description: ""
pubDate: "2025-08-27"
heroImage: ""
---

# 数值分析05:线性系统迭代法及其收敛性理论

### **引言：为何迭代？如何迭代？**

在上一讲中，我们已经初步接触了用迭代法求解线性系统的思想。今天，我们将正式、系统地深入这个主题。

让我们再次回到那个核心问题：我们已经有了稳定可靠的、经过主元法改进的高斯消元法这样的**直接法**，为什么还需要发展**迭代法**？

答案主要在于**处理超大规模稀疏系统**时的巨大优势。想象一下，在天气预报、飞机设计或材料科学中，我们需要求解的线性方程组的维度 $n$ 可能高达数百万。

*   **直接法 ($O(n^3)$):** 即使是现代超级计算机，一个百万维度的稠密系统的 $10^{18}$ 次浮点运算也是一个巨大的挑战。
*   **存储：** 存储一个百万乘百万的稠密矩阵需要 $10^{12}$ 个浮点数，约等于8000GB的内存，这通常是不现实的。
*   **稀疏性破坏：** 更关键的是，这些系统通常是**稀疏**的，例如，每行只有5-10个非零元素。直接法中的行变换会引入大量非零元（称为**Fill-in**），彻底破坏这种宝贵的稀疏结构，导致内存需求激增。

**迭代法**正是为了克服这些困难而生。它有两大吸引力：

1.  **内存友好：** 迭代过程通常只涉及矩阵和向量的乘法 ($A\\mathbf{x}^{(k)}$)，可以完美地利用矩阵的稀疏性，存储需求仅为 $O(\\text{nnz})$（非零元数量），远小于 $O(n^2)$。
2.  **可控精度：** 我们可以根据实际需求设定容差，迭代到满足精度要求即可停止，无需进行完整的 $O(n^3)$ 运算。对于某些问题，一个中等精度的解可能就足够了。

上一讲我们已经建立了迭代法的基本框架：将 $A\\mathbf{x}=\\mathbf{b}$ 转化为等价的不动点形式 $\\mathbf{x} = T\\mathbf{x}+\\mathbf{c}$，然后进行迭代 $\\mathbf{x}^{(k+1)}=T\\mathbf{x}^{(k)}+\\mathbf{c}$。

今天，我们将详细探讨以下几个问题：

1.  **经典迭代法：** Jacobi和Gauss-Seidel方法的具体实现和对比。
2.  **收敛性理论：** 迭代法到底在什么条件下才收敛？这是本讲的理论核心。
3.  **加速收敛：** 如何改进Gauss-Seidel方法，得到收敛更快的SOR方法？
4.  **实践分析：** 如何通过分析迭代矩阵的特征值来判断收敛性并找到最优参数？

### **第一部分：经典迭代格式**

我们再次使用矩阵分裂的思想 $A=D-L-U$ 来构造迭代格式。

#### **7.3.1 Jacobi 迭代法**

**推导：** $$A\\mathbf{x} = \\mathbf{b} \\implies (D-L-U)\\mathbf{x} = \\mathbf{b} \\implies D\\mathbf{x} = (L+U)\\mathbf{x} + \\mathbf{b}$$ 假设所有对角元 $a\_{ii} \\neq 0$，则 $D$ 可逆： $$\\mathbf{x} = D^{-1}(L+U)\\mathbf{x} + D^{-1}\\mathbf{b}$$

**Jacobi 迭代格式：** $$\\mathbf{x}^{(k+1)} = \\underbrace{D^{-1}(L+U)}\_{T\_J} \\mathbf{x}^{(k)} + \\underbrace{D^{-1}\\mathbf{b}}\_{\\mathbf{c}\_J}$$

**分量形式 (Component-wise Form):** $$x\_i^{(k+1)} = \\frac{1}{a\_{ii}} \\left( b\_i - \\sum\_{j=1, j \\neq i}^{n} a\_{ij}x\_j^{(k)} \\right), \\quad \\text{for } i=1, \\dots, n$$

**实现要点：**

*   **两个向量存储：** 从分量形式可以看出，为了计算新的向量 $\\mathbf{x}^{(k+1)}$ 的每一个分量，我们都需要**完整的旧向量 $\\mathbf{x}^{(k)}$**。因此，在实现时，我们需要两个数组，一个用于存储`x_old` ($\\mathbf{x}^{(k)}$)，一个用于存储`x_new` ($\\mathbf{x}^{(k+1)}$)。在一轮迭代完全结束后，再将`x_new`复制给`x_old`。
*   **并行性：** 各个分量 $x\_i^{(k+1)}$ 的计算是**相互独立**的，可以完美地分配给不同的处理器并行计算，这在高性能计算中是一个巨大优势。

#### **7.3.2 Gauss-Seidel 迭代法**

**思想：** "A bit wasteful, isn't it?"Jacobi方法在计算 $x\_i^{(k+1)}$ 时，没有利用已经算出的、更新的 $x\_1^{(k+1)}, \\dots, x\_{i-1}^{(k+1)}$。Gauss-Seidel方法修正了这一点。

**推导：** $$(D-L-U)\\mathbf{x} = \\mathbf{b} \\implies (D-L)\\mathbf{x} = U\\mathbf{x} + \\mathbf{b}$$ 我们将所有包含“新”分量的项移到左边，“旧”分量的项留在右边。

**Gauss-Seidel 迭代格式：** $$\\mathbf{x}^{(k+1)} = \\underbrace{(D-L)^{-1}U}\_{T\_{GS}} \\mathbf{x}^{(k)} + \\underbrace{(D-L)^{-1}\\mathbf{b}}\_{\\mathbf{c}\_{GS}}$$

**分量形式 (Component-wise Form):** $$x\_i^{(k+1)} = \\frac{1}{a\_{ii}} \\left( b\_i - \\sum\_{j=1}^{i-1} a\_{ij}x\_j^{(k+1)} - \\sum\_{j=i+1}^{n} a\_{ij}x\_j^{(k)} \\right), \\quad \\text{for } i=1, \\dots, n$$

**实现要点：**

*   **一个向量存储：** 从分量形式可以看出，我们可以用**一个数组**原地更新。在计算 $x\_i^{(k+1)}$ 时，数组中前 $i-1$ 个元素已经是本次迭代更新过的值，后 $n-i$ 个元素还是上一次迭代的值。这节省了一半的内存。
*   **串行性：** $x\_i^{(k+1)}$ 的计算依赖于 $x\_{i-1}^{(k+1)}$，因此必须按顺序 $i=1, 2, \\dots, n$ 进行，不适合直接并行化。

**收敛性对比：**

*   直观上，Gauss-Seidel使用了最新信息，人们期望它收敛更快。在很多情况下（例如对于严格对角占优或对称正定矩阵），确实如此。
*   然而，“Neither of the methods are always convergent. And more, there are cases in which Jacobi method fails while Gauss-Seidel is convergent, and vice-versa.” 存在Jacobi收敛而Gauss-Seidel发散的例子，反之亦然。它们的收敛性取决于迭代矩阵的谱半径，而 $\\rho(T\_J)$ 和 $\\rho(T\_{GS})$ 之间没有绝对的大小关系。

### **第二部分：收敛性理论**

这是理解所有迭代法行为的核心。

#### **7.2.1 谱半径与矩阵收敛**

我们已经知道，迭代法 $\\mathbf{x}^{(k+1)} = T\\mathbf{x}^{(k)} + \\mathbf{c}$ 收敛的充要条件是 $\\lim\_{k\\to\\infty} T^k = O$ (零矩阵)。满足这个条件的矩阵被称为**收敛矩阵 (Convergent Matrix)**。

**定义 (谱半径 - Spectral Radius):** 一个矩阵 $A$ 的谱半径 $\\rho(A)$ 是其所有特征值绝对值的最大值。 $$\\rho(A) = \\max {|\\lambda| : \\lambda \\text{ is an eigenvalue of } A}$$

**定理 (收敛矩阵的等价条件):** 对于一个 $n \\times n$ 矩阵 $A$，以下陈述是等价的：

1.  $A$ 是一个收敛矩阵 (即 $\\lim\_{k\\to\\infty} A^k = O$)。
2.  对于**某个**自然矩阵范数，$\\lim\_{k\\to\\infty} |A^k| = 0$。
3.  对于**所有**自然矩阵范数，$\\lim\_{k\\to\\infty} |A^k| = 0$。
4.  $A$ 的谱半径**严格小于1**，即 $\\rho(A) < 1$。
5.  对于任意向量 $\\mathbf{x}$，都有 $\\lim\_{k\\to\\infty} A^k \\mathbf{x} = \\mathbf{0}$。

这个定理是线性迭代法理论的基石。它告诉我们，判断一个迭代法是否收敛，最终归结为计算其迭代矩阵的谱半径。

**谱半径与范数的关系：** **定理：** 对于任意自然矩阵范数 $|\\cdot|$ 和任意矩阵 $A$，都有 $\\rho(A) \\le |A|$。

*   **证明思路：** 设 $\\lambda$ 是 $A$ 的一个特征值，$\\mathbf{v}$ 是对应的特征向量。则 $A\\mathbf{v} = \\lambda\\mathbf{v}$。 $|\\lambda||\\mathbf{v}| = |\\lambda\\mathbf{v}| = |A\\mathbf{v}| \\le |A||\\mathbf{v}|$。 由于 $\\mathbf{v}$ 非零，两边消去 $|\\mathbf{v}|$ 得到 $|\\lambda| \\le |A|$。这对所有特征值都成立，所以 $\\rho(A) = \\max|\\lambda| \\le |A|$。

#### **7.2.2 收敛性定理**

结合以上理论，我们可以给出迭代法收敛性的最终定理。

**定理 (线性迭代法收敛性):** 对于任意初始向量 $\\mathbf{x}^{(0)} \\in \\mathbb{R}^n$，由 $\\mathbf{x}^{(k+1)} = T\\mathbf{x}^{(k)} + \\mathbf{c}$ 生成的序列收敛到方程 $\\mathbf{x}=T\\mathbf{x}+\\mathbf{c}$ 的唯一解的**充分必要条件**是 $\\rho(T) < 1$。

**证明思路 (简述):**

*   ($\\Leftarrow$) **如果 $\\rho(T)<1$，则收敛：** 误差关系为 $\\mathbf{e}^{(k)} = T^k \\mathbf{e}^{(0)}$。因为 $\\rho(T)<1$，所以 $T$ 是收敛矩阵，$\\lim\_{k\\to\\infty} T^k = O$。因此 $\\lim\_{k\\to\\infty} \\mathbf{e}^{(k)} = \\mathbf{0}$。
*   ($\\Rightarrow$) **如果对任意初值都收敛，则 $\\rho(T)<1$：** (反证法) 假设 $\\rho(T) \\ge 1$。那么存在一个特征值 $\\lambda$ 使得 $|\\lambda| \\ge 1$。设其对应的特征向量为 $\\mathbf{v}$。如果我们选择初始误差 $\\mathbf{e}^{(0)} = \\mathbf{v}$，那么 $\\mathbf{e}^{(k)} = T^k \\mathbf{v} = \\lambda^k \\mathbf{v}$。 $|\\mathbf{e}^{(k)}| = |\\lambda|^k |\\mathbf{v}|$。由于 $|\\lambda| \\ge 1$，这个误差范数不会趋于0，所以序列不收敛。这与“对任意初值都收敛”的前提矛盾。

**实用的充分条件：** 计算谱半径通常很困难。一个更容易验证的**充分条件**是： **如果存在某个自然矩阵范数使得 $|T| < 1$，则迭代法保证收敛。** 例如，对于Jacobi法，我们可以计算 $|T\_J|\_\\infty = |D^{-1}(L+U)|\_\\infty$。如果这个值小于1，Jacobi就收敛。

**定理 (对角占优保证收敛):** 如果矩阵 $A$ 是**严格对角占优**的，那么 Jacobi 和 Gauss-Seidel 方法都收敛。

*   **证明思路 (以Jacobi为例):** 对于严格对角占优矩阵，可以证明其Jacobi迭代矩阵 $T\_J$ 的无穷范数满足 $|T\_J|\_\\infty = \\max\_i \\sum\_{j \\neq i} \\frac{|a\_{ij}|}{|a\_{ii}|} < 1$。根据范数收敛准则，Jacobi法收敛。Gauss-Seidel的证明更复杂一些，但结论相同。

#### **7.3.3 SOR 方法：加速 Gauss-Seidel**

**思想：** 从另一个角度看待Gauss-Seidel。 Gauss-Seidel的第 $i$ 步实际上是先计算一个Jacobi式的中间值 $\\tilde{x}\_i^{(k+1)}$，然后立即用它更新 $x\_i^{(k)}$。我们可以看作是 $x\_i^{(k)}$ 加上一个修正量。 令 $r\_i^{(k)} = b\_i - \\sum\_{j=1}^n a\_{ij}x\_j^{(k)}$ 是第 $k$ 步的残差向量的第 $i$ 个分量。 Gauss-Seidel的更新可以写成：$x\_i^{(k+1)} = x\_i^{(k)} + \\frac{r\_i^{(k)}}{a\_{ii}}$ （这里 $r\_i$ 内部混合了新旧分量）。

**松弛法 (Relaxation):** 我们不必完全“相信”Gauss-Seidel给出的修正步长。我们可以引入一个**松弛因子 (Relaxation Factor)** $\\omega$，来控制我们朝修正方向“走多远”。

**逐次超松弛法 (Successive Over-Relaxation, SOR) 迭代格式:** $$x\_i^{(k+1)} = (1-\\omega)x\_i^{(k)} + \\omega \\left\[ \\frac{1}{a\_{ii}} \\left( b\_i - \\sum\_{j=1}^{i-1} a\_{ij}x\_j^{(k+1)} - \\sum\_{j=i+1}^{n} a\_{ij}x\_j^{(k)} \\right) \\right\]$$

*   当 $\\omega=1$ 时，SOR **退化为 Gauss-Seidel**。
*   当 $0 < \\omega < 1$ 时，称为**欠松弛 (Under-Relaxation)**，用于稳定某些发散的迭代。
*   当 $\\omega > 1$ 时，称为**超松弛 (Over-Relaxation)**，用于加速收敛。我们通常关心这种情况。

**SOR 迭代矩阵:** $$T\_\\omega = (D-\\omega L)^{-1}((1-\\omega)D + \\omega U)$$

**SOR 收敛性定理:**

*   **Kahan 定理：** $\\rho(T\_\\omega) \\ge |\\omega-1|$。这意味着SOR要收敛，**$\\omega$ 必须在 $(0, 2)$ 区间内**。这是一个必要条件。
*   **Ostrowski-Reich 定理：** 如果 $A$ 是**对称正定**的，那么只要 $0 < \\omega < 2$，SOR就保证收敛。

对于特定类型的矩阵（如对称正定三对角矩阵），甚至可以计算出使 $\\rho(T\_\\omega)$ 最小的**最优松弛因子 $\\omega\_{opt}$**： $$\\omega\_{opt} = \\frac{2}{1+\\sqrt{1 - \[\\rho(T\_J)\]^2}}$$

### **第三部分：收敛性分析实践**

**Discussion 14: 分析一个迭代方法** 给定矩阵 $A = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$, $\\mathbf{b} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 和一个迭代格式： $$\\mathbf{x}^{(k+1)} = \\mathbf{x}^{(k)} + \\omega(A\\mathbf{x}^{(k)} - \\mathbf{b})$$ 这是一个求解 $A\\mathbf{x}=\\mathbf{b}$ 的迭代法吗？不，它是求解 $A\\mathbf{x}-\\mathbf{b}=\\mathbf{0}$，但迭代格式写错了。正确的应该是求解 $A\\mathbf{x}=\\mathbf{b}$ 的残差修正法，如 $\\mathbf{x}^{(k+1)} = \\mathbf{x}^{(k)} + \\omega(\\mathbf{b} - A\\mathbf{x}^{(k)})$。

**1\. 找出迭代矩阵 $T$:** $$\\mathbf{x}^{(k+1)} = (\\mathbf{I} + \\omega A)\\mathbf{x}^{(k)} - \\omega \\mathbf{b}$$ 所以，迭代矩阵 $T = \\mathbf{I} + \\omega A = \\begin{pmatrix} 1+2\\omega & \\omega \\\\ \\omega & 1+2\\omega \\end{pmatrix}$。

**2\. 计算 $T$ 的特征值来得到谱半径:** 特征方程为 $\\det(T-\\lambda\\mathbf{I}) = 0$。 $$(1+2\\omega - \\lambda)^2 - \\omega^2 = 0$$ $$1+2\\omega - \\lambda = \\pm \\omega$$ $$\\lambda = 1+2\\omega \\mp \\omega$$ 所以特征值为 $\\lambda\_1 = 1+\\omega$ 和 $\\lambda\_2 = 1+3\\omega$。

**3\. 分析收敛条件:** 要使迭代收敛，谱半径 $\\rho(T) = \\max\\{|1+\\omega|, |1+3\\omega|\\} < 1$。 这需要同时满足两个不等式： (1) $-1 < 1+\\omega < 1 \\implies -2 < \\omega < 0$ (2) $-1 < 1+3\\omega < 1 \\implies -2 < 3\\omega < 0 \\implies -2/3 < \\omega < 0$ 两个条件的交集是 **$-2/3 < \\omega < 0$**。

**4\. 寻找最优 $\\omega$:** 我们需要找到 $\\omega$ 使得 $\\rho(T)$ 最小。我们需要最小化函数 $f(\\omega) = \\max\\{|1+\\omega|, |1+3\\omega|\\}$。 画出两个函数 $|1+\\omega|$ (V型，顶点在-1) 和 $|1+3\\omega|$ (更窄的V型，顶点在-1/3) 的图像。

最大值函数的最小值出现在两条线的交点处，即： $$|1+\\omega| = |1+3\\omega|$$ 在收敛区间 $(-2/3, 0)$ 内，$1+\\omega > 0$，$1+3\\omega$ 可能为正也可能为负。 若 $1+3\\omega \\ge 0$ (即 $\\omega \\ge -1/3$)，则 $1+\\omega = 1+3\\omega \\implies \\omega=0$，不在区间内。 若 $1+3\\omega < 0$ (即 $\\omega < -1/3$)，则 $1+\\omega = -(1+3\\omega) = -1-3\\omega \\implies 4\\omega = -2 \\implies \\omega = -1/2$。 这个值在收敛区间内。 当 $\\omega = -1/2$ 时，$\\rho(T) = |1-1/2| = |1-3/2| = 0.5$。这就是最小的谱半径。

因此，最优松弛因子是 $\\omega\_{opt} = -1/2$。

### **课程总结**

**本讲核心要点：**

1.  **Jacobi** 和 **Gauss-Seidel** 是将矩阵 $A$ 分裂为 $D-L-U$ 得到的两种基础迭代法，前者易于并行，后者通常收敛更快且节省内存。
2.  迭代法收敛的**充要条件是迭代矩阵的谱半径 $\\rho(T)<1$**。这是一个深刻的理论结果，将线性代数的特征值理论与迭代过程的收敛性联系起来。
3.  **范数小于1** ($ |T| < 1 $) 是一个更容易计算的**充分条件**，而**严格对角占优**是保证Jacobi和GS收敛的一个更易判断的矩阵性质。
4.  **SOR方法**通过引入松弛因子 $\\omega$ 来加速Gauss-Seidel，收敛的必要条件是 $0 < \\omega < 2$。选择最优的 $\\omega$ 可以显著提升收敛速度。

**Lab 04 ：Jacobi 与 Gauss-Seidel 对比** **任务：** 编写程序，用Jacobi和Gauss-Seidel方法求解给定的线性系统，并对比它们的表现。 **关键提示 (Note):**

*   实验要求实现一种**预处理**策略来增强对角占优性：对于每一行 $i$，从该行向下扫描第 $i$ 列，找到绝对值最大的元素，通过**行交换**将其放到对角线位置。如果找不到非零元，则向上扫描，找到非零元后将其所在行**加到**第 $i$ 行。这种操作旨在尽可能地满足收敛条件，是数值实践中提高算法鲁棒性的常用技巧。
*   你需要分别实现两种算法，对同一个问题进行求解，并可能需要记录迭代次数或运行时间来对比效率。