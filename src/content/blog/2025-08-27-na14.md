---
title: "数值分析14:多步法的系统构造与高阶微分方程组"
description: ""
pubDate: "2025-08-27"
heroImage: ""
---

# 数值分析14:多步法的系统构造与高阶微分方程组

### **引言：多步法的“基因”与 ODE 求解的“升维”**

在上一讲中，我们学习了求解常微分方程（ODE）的两大主流方法族：**单步法**（以龙格-库塔为代表）和**多步法**（以 Adams 方法为代表）。我们了解到，多步法通过利用历史信息，在函数求值效率上可能优于单步法，特别是通过**预测-校正**策略，实现了精度、效率和稳定性的精妙平衡。

我们上一讲是从**积分**的角度推导多步法的，即把 $y(t\_{i+1}) = y(t\_i) + \\int\_{t\_i}^{t\_{i+1}} f(t,y)dt$ 中的积分项用插值多项式来近似。今天课程的第一部分，我们将从另一个更基本、更强大的视角来审视多步法：**泰勒展开 (Taylor Expansion)**。

**"Derive from Taylor expansion"** 这个视角将为我们揭示所有线性多步法的“遗传密码”。我们将看到，任何一个形如 $w\_{i+1} = \\sum a\_j w\_{i-j} + h \\sum b\_j f\_{i+1-j}$ 的线性多步法，其系数 ${a\_j}$ 和 ${b\_j}$ 都可以通过一个系统性的**待定系数法**来确定：将公式中的所有项在中心点 $t\_i$ 处进行泰勒展开，然后匹配 $h$ 的各次幂系数，使得方法的**局部截断误差 (Local Truncation Error)** 达到我们想要的阶数。这个过程不仅能让我们重新推导出已知的 Adams 方法，还能创造出全新的方法族，如**米尔恩 (Milne's)** 方法。

课程的第二部分，我们将进行一次重要的“升维打击”。到目前为止，我们所有的讨论都局限于**一阶单变量**的 ODE 问题 $\\frac{dy}{dt}=f(t,y)$。然而，现实世界中的绝大多数动态系统，要么由**高阶微分方程**描述（例如，牛顿第二定律 $F=ma$ 是一个二阶 ODE），要么由多个相互耦合的一阶 ODE 组成的**方程组**描述（例如，捕食者-被捕食者模型）。

我们是否需要为这些更复杂的问题重新发明一套全新的数值方法？答案是：**完全不需要！** 存在一个极其优美的技巧，可以将**任何**高阶 ODE 或 ODE 系统，转化为一个等价的**一阶 ODE 系统**。这意味着，我们之前辛辛苦苦学过的所有方法（欧拉、龙格-库塔、Adams 等）都可以**直接**应用于求解这些看似复杂得多的问题，只需将标量运算替换为向量运算即可。

### **第一部分：多步法的泰勒展开构造法**

#### **5.6 (II) 通用线性多步法**

一个通用的 $m$ 步线性多步法 (Linear Multistep Method, LMM) 具有如下形式： $$w\_{i+1} = \\sum\_{j=0}^{m-1} a\_j w\_{i-j} + h \\sum\_{j=-1}^{m-1} b\_j f\_{i-j}$$ 其中 $f\_k = f(t\_k, w\_k)$。为了方便，我们通常写成： $$w\_{i+1} = a\_{m-1}w\_i + a\_{m-2}w\_{i-1} + \\dots + a\_0 w\_{i+1-m} + h\[b\_m f\_{i+1} + b\_{m-1}f\_i + \\dots + b\_0 f\_{i+1-m}\]$$

*   如果 $b\_m=0$，公式是**显式 (Explicit)** 的，因为右端不依赖于未知的 $w\_{i+1}$。
*   如果 $b\_m \\neq 0$，公式是**隐式 (Implicit)** 的。

**问题：** 如何系统地确定这些系数 $a\_j$ 和 $b\_j$ 来获得一个具有特定**阶数 (order)** $p$ 的方法？ （阶数为 $p$ 意味着局部截断误差 $\\tau\_{i+1}(h) = O(h^p)$）。

#### **5.6 (II) 待定系数法**

**核心思想：**

1.  写下我们想要的通用公式形式，例如，一个显式的三步四阶方法： $$w\_{i+1} = a\_2 w\_i + a\_1 w\_{i-1} + a\_0 w\_{i-2} + h\[b\_3 f\_i + b\_2 f\_{i-1} + b\_1 f\_{i-2} + b\_0 f\_{i-3}\]$$
2.  定义该方法的局部截断误差 $\\tau\_{i+1}(h) = \\frac{y(t\_{i+1}) - (\\sum a\_j y\_{i-j} + h \\sum b\_j y'\_{i-j})}{h}$。
3.  **"Expand ... in Taylor series about $t\_i$."** 将公式中涉及到的所有 $y(t\_{i-j})$ 和 $y'(t\_{i-j})$ 项，全部在中心点 $t\_i$ 进行泰勒展开。
4.  将这些展开式代入 $\\tau\_{i+1}(h)$ 的表达式中，整理出关于 $h$ 的幂级数。
5.  **"equate the coefficients of $h^k$."**为了让方法的阶数为 $p$，我们要求 $\\tau\_{i+1}(h) = O(h^p)$，这意味着展开式中从 $h^0$ 到 $h^{p-1}$ 的所有项的系数都必须为零。
6.  这就构成了一个关于未知系数 $a\_j, b\_j$ 的**线性方程组**。求解这个方程组，即可得到我们想要的方法。

**例：推导一个四阶显式方法 (Example)** 目标形式: $w\_{i+1} = a\_2 w\_i + a\_1 w\_{i-1} + a\_0 w\_{i-2} + h\[b\_3 f\_i + b\_2 f\_{i-1} + b\_1 f\_{i-2} + b\_0 f\_{i-3}\]$ 我们有 7 个未知数: $a\_2, a\_1, a\_0, b\_3, b\_2, b\_1, b\_0$。 我们将 $y(t\_{i+1}), y\_{i-1}, y\_{i-2}, y'\_{i-1}, y'\_{i-2}, y'\_{i-3}$ 全部在 $t\_i$ 处展开至 $O(h^5)$（为了得到 $O(h^4)$ 的方法，$\\tau$ 的分子需要是 $O(h^5)$）。

*   $y(t\_{i+1}) = y\_i + hy'\_i + \\frac{h^2}{2}y''\_i + \\frac{h^3}{6}y'''\_i + \\frac{h^4}{24}y^{(4)}\_i + O(h^5)$
*   $y\_{i-1} = y\_i - hy'\_i + \\frac{h^2}{2}y''\_i - \\dots$
*   ... (以此类推，共6个展开式)

将这些展开式代入 $\\tau\_{i+1}(h)$ 的分子 $y(t\_{i+1}) - (\\dots)$，然后按 $y\_i, y'\_i, y''\_i, \\dots$ 的各阶导数整理系数。 为了让 $\\tau\_{i+1}(h) = O(h^4)$，我们必须让 $h^0, h^1, h^2, h^3, h^4$ 的系数都为零。

*   $h^0$ (即 $y\_i$ 的系数): $1 - (a\_2+a\_1+a\_0) = 0$
*   $h^1$ (即 $y'\_i$ 的系数): $1 - (-a\_1-2a\_0) - (b\_3+b\_2+b\_1+b\_0) = 0$
*   ...
*   $h^4$ (即 $y^{(4)}\_i$ 的系数): $\\frac{1}{24} - (\\frac{a\_1}{24}+\\frac{16a\_0}{24}) - (\\frac{b\_2}{6}+\\frac{8b\_1}{6}+\\frac{27b\_0}{6}) = 0$

我们得到了 **5 个方程**，但有 **7 个未知数**。 "5 equations and 7 unknowns" 这意味着存在一个具有**两个自由度**的方法族。我们可以通过指定其中两个系数的值，来确定一个具体的方法。

**派生出不同的方法族：**

*   **Adams-Bashforth (显式):**
    
    *   这类方法的核心思想是“纯积分”，它只利用过去的斜率信息，而不直接利用过去的点的位置信息。这对应于设置 $a\_1=a\_2=\\dots=a\_{m-2}=0, a\_{m-1}=1$。
    *   在我们的例子中，如果设 $a\_2=1, a\_1=0, a\_0=0$，我们就可以解出 $b\_3, b\_2, b\_1, b\_0$，从而得到四阶 Adams-Bashforth 方法。
*   **Adams-Moulton (隐式):**
    
    *   类似的，我们设置 $a\_1=a\_2=\\dots=a\_{m-2}=0, a\_{m-1}=1$，但在 $b$ 系数中包含 $b\_m f\_{i+1}$ 项。
*   **米尔恩方法 (Milne's Method):**
    
    *   这是另一类重要的方法，它通过让尽可能多的低阶 $a\_j$ 系数为零来获得最简单的形式。
    *   在我们的例子中，如果设置 $a\_2=0, a\_1=0$，则无法获得四阶方法。但如果我们的目标形式是 $w\_{i+1} = a\_1 w\_i + a\_0 w\_{i-1} + h(\\dots)$，则可以推导出**辛普森-米尔恩 (Simpson-Milne)** 方法族。
    *   **显式 Milne's 法 (四阶):** $$w\_{i+1} = w\_{i-3} + \\frac{4h}{3}(2f\_i - f\_{i-1} + 2f\_{i-2})$$
    *   **隐式 Milne's 法 (辛普森法则, 四阶):** $$w\_{i+1} = w\_{i-1} + \\frac{h}{3}(f\_{i+1} + 4f\_i + f\_{i-1})$$ 这个公式非常著名，它来源于在 $\[t\_{i-1}, t\_{i+1}\]$ 上对 $y'$ 用辛普森法则积分。

**Milne's 方法的缺陷：** 虽然这些方法的局部截断误差常数很小，但它们存在严重的**稳定性问题**（弱稳定性），在长时间积分时可能会产生振荡解，因此在现代求解器中已不常用。

#### **5.6 (II) 预测-校正的误差估计与改进**

**Research topic 16:** 我们已经知道，四阶 AB-AM 预测-校正系统非常高效。我们能否利用其误差结构来做得更好？

*   **预测步 (AB4):** $y(t\_{i+1}) - w\_{i+1}^\* \\approx \\frac{251}{720}h^5 y^{(5)}(\\xi)$
*   **校正步 (AM4):** $y(t\_{i+1}) - w\_{i+1} \\approx -\\frac{19}{720}h^5 y^{(5)}(\\xi)$

假设 $y^{(5)}(t)$ 在一个步长内变化不大，我们可以得到一个惊人的关系： $$y(t\_{i+1}) - w\_{i+1} \\approx -\\frac{19}{251} (y(t\_{i+1}) - w\_{i+1}^\*)$$ 两边都包含未知的真解 $y(t\_{i+1})$。但我们可以用校正值 $w\_{i+1}$ 来近似它： $$w\_{i+1} - w\_{i+1}^\* \\approx (y(t\_{i+1}) - w\_{i+1}^\*) - (y(t\_{i+1}) - w\_{i+1}) \\approx \\frac{251+19}{720}h^5 y^{(5)}(\\xi) = \\frac{270}{720}h^5 y^{(5)}(\\xi)$$

**局部误差估计：** $$\\text{Local Error} = y(t\_{i+1}) - w\_{i+1} \\approx -\\frac{19}{270}(w\_{i+1} - w\_{i+1}^\*)$$ 这个公式允许我们在**每一步之后**，都对该步引入的局部截断误差进行一个**可计算的估计**！这对于**自适应步长控制**至关重要：

*   如果估计误差大于容差，我们就拒绝这一步，用一个更小的步长 $h$ 重算。
*   如果估计误差远小于容差，我们可以尝试在下一步增大步长 $h$ 以提高效率。

**米尔恩误差修正 (Milne's error correction):** 更有甚者，既然我们能估计出误差，为什么不直接用它来修正我们的结果呢？ **PECEC 模式 (Predict-Evaluate-Correct-Evaluate-Correct):** 我们可以再增加一个修正步骤，得到一个更精确的结果 $w\_{i+1}^{final}$。这种思想构成了更高级的、变阶变步长的 ODE 求解器的基础。

### **第二部分：高阶方程与微分方程组**

#### **5.9.1 从高阶到一阶系统**

**核心思想：** 通过引入新变量，将一个 $m$ 阶的 ODE 转化为一个包含 $m$ 个方程的**一阶 ODE 系统**。

**一般 $m$ 阶 ODE:** $$y^{(m)}(t) = f(t, y, y', \\dots, y^{(m-1)})$$ 以及 $m$ 个初始条件: $y(a)=\\alpha\_1, y'(a)=\\alpha\_2, \\dots, y^{(m-1)}(a)=\\alpha\_m$。

**转化步骤：**

1.  定义一组新的因变量： $u\_1(t) = y(t)$ $u\_2(t) = y'(t)$ $u\_3(t) = y''(t)$ ... $u\_m(t) = y^{(m-1)}(t)$
2.  写出这些新变量之间的关系： $u'\_1 = (y)' = y' = u\_2$ $u'\_2 = (y')' = y'' = u\_3$ ... $u'\_{m-1} = (y^{(m-2)})' = y^{(m-1)} = u\_m$
3.  写出最后一个新变量的导数，利用原始的 ODE： $u'\_m = (y^{(m-1)})' = y^{(m)} = f(t, y, \\dots, y^{(m-1)}) = f(t, u\_1, u\_2, \\dots, u\_m)$
4.  写出新的初始条件： $u\_1(a) = \\alpha\_1$ $u\_2(a) = \\alpha\_2$ ... $u\_m(a) = \\alpha\_m$

**结果：** 我们得到了一个**一阶常微分方程组**： $$\\begin{cases} u'\_1 &= u\_2 \\\\ u'\_2 &= u\_3 \\\\ &\\vdots \\\\ u'\_{m-1} &= u\_m \\\\ u'\_m &= f(t, u\_1, \\dots, u\_m) \\end{cases}$$ 以及初始条件 $\\mathbf{u}(a) = \\mathbf{\\alpha}$。

我们可以将它写成优雅的**向量形式**： 令 $\\mathbf{u}(t) = \[u\_1(t), \\dots, u\_m(t)\]^T$，则 $$\\mathbf{u}'(t) = \\mathbf{F}(t, \\mathbf{u}(t))$$ 其中 $\\mathbf{F}$ 是一个向量函数。这个形式与我们之前研究的一阶单变量 ODE $y'=f(t,y)$ **完全相同**！

#### **5.9.2 数值方法的推广**

这意味着，我们之前学过的所有单步法都可以直接推广来求解这个系统。我们只需将所有标量运算替换为向量运算即可。

**以修正欧拉法（RK2的一种）为例 (Discussion 34):** 求解二阶 IVP: $y'' - 2y' + y = te^t - t, \\quad y(0)=0, y'(0)=-0.5$

1.  **转化为一阶系统：** 令 $u\_1 = y, u\_2 = y'$。 $u'\_1 = y' = u\_2$ $u'\_2 = y'' = 2y' - y + te^t - t = 2u\_2 - u\_1 + te^t - t$ 初始条件: $u\_1(0)=0, u\_2(0)=-0.5$。 向量形式: $\\mathbf{u}' = \\begin{pmatrix} u'\_1 \\\\ u'\_2 \\end{pmatrix} = \\begin{pmatrix} u\_2 \\\\ 2u\_2 - u\_1 + te^t - t \\end{pmatrix} = \\mathbf{F}(t, \\mathbf{u})$。
    
2.  **应用修正欧拉法 (向量版):** $\\mathbf{w}\_0 = \[0, -0.5\]^T$ $\\mathbf{K}\_1 = \\mathbf{F}(t\_i, \\mathbf{w}\_i)$ $\\mathbf{K}\_2 = \\mathbf{F}(t\_i+h, \\mathbf{w}\_i+h\\mathbf{K}\_1)$ $\\mathbf{w}\_{i+1} = \\mathbf{w}\_i + \\frac{h}{2}(\\mathbf{K}\_1 + \\mathbf{K}\_2)$
    
    **计算第一步 (i=0, h=0.1):**
    
    *   $t\_0=0, \\mathbf{w}\_0 = \[0, -0.5\]^T$
    *   $\\mathbf{K}\_1 = \\mathbf{F}(0, \[0, -0.5\]) = \\begin{pmatrix} -0.5 \\\\ 2(-0.5)-0+0-0 \\end{pmatrix} = \\begin{pmatrix} -0.5 \\\\ -1.0 \\end{pmatrix}$
    *   $\\mathbf{K}\_2 = \\mathbf{F}(0.1, \\mathbf{w}\_0 + 0.1\\mathbf{K}\_1) = \\mathbf{F}(0.1, \[0, -0.5\] + \[-0.05, -0.1\]) = \\mathbf{F}(0.1, \[-0.05, -0.6\])$ $= \\begin{pmatrix} -0.6 \\\\ 2(-0.6) - (-0.05) + 0.1e^{0.1} - 0.1 \\end{pmatrix} \\approx \\begin{pmatrix} -0.6 \\\\ -1.139 \\end{pmatrix}$
    *   $\\mathbf{w}\_1 = \\mathbf{w}\_0 + \\frac{0.1}{2}(\\mathbf{K}\_1 + \\mathbf{K}\_2) = \\begin{pmatrix} 0 \\\\ -0.5 \\end{pmatrix} + 0.05 \\begin{pmatrix} -1.1 \\\\ -2.139 \\end{pmatrix} = \\begin{pmatrix} -0.055 \\\\ -0.60695 \\end{pmatrix}$

我们就这样一步步地计算出了 $y(0.1)$ 和 $y'(0.1)$ 的近似值。

**结论：** 求解高阶方程和方程组的数值方法，在理论和实现上，与求解一阶单变量方程的方法并无本质区别，这极大地统一了ODE数值解法的理论框架。

### **课程总结**

**本讲核心要点：**

1.  **多步法的系统构造：** 任何线性多步法都可以通过在中心点进行泰勒展开，并令低阶项系数为零的**待定系数法**来系统地推导。这揭示了不同方法族（如 Adams 和 Milne）之间的内在联系。
2.  **预测-校正的威力：** 通过比较预测值和校正值，我们不仅可以**实时估计局部截断误差**，为自适应步长控制打下基础，还可以进一步修正结果以提高精度。
3.  **高阶ODE的降阶：** 任何 $m$ 阶 ODE 或 ODE 系统都可以被严格地转化为一个等价的**一阶 ODE 系统**。
4.  **数值方法的普适性：** 我们为一阶单变量 ODE 发展的数值方法（欧拉、RK、多步法等）可以**直接推广**到求解一阶系统，只需将标量运算替换为向量运算即可。