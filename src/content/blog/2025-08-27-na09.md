---
title: "数值分析09:正交多项式与最小二乘逼近"
description: ""
pubDate: "2025-08-27"
heroImage: ""
---

# 数值分析09:正交多项式与最小二乘逼近

### **引言：从多项式拟合到正交**

在上一讲中，我们完成了从**插值**到**逼近**的思想转变。我们认识到，当处理带有噪声的实验数据时，强求曲线穿过每一个点是不可取的，转而寻求一个能捕捉数据整体趋势的“最佳拟合”函数更为合理。我们选择了**最小二乘法**作为“最佳”的标准，并通过求解**法方程**来确定多项式的系数。

这看起来是一个完美的解决方案。我们以二次多项式拟合为例，通过求解一个3x3的法方程组，得到了拟合曲线 $y=a\_0+a\_1x+a\_2x^2$。

**"It is soooo simple! What can possibly go wrong?"**

这里潜藏着一个巨大的数值陷阱。让我们回顾一下那个例子 (Discussion 22) 中法方程的系数矩阵： $$B = \\begin{pmatrix} 4 & 10 & 30 \\\\ 10 & 30 & 100 \\\\ 30 & 100 & 354 \\end{pmatrix}$$ 我们计算出它的无穷范数条件数 $K\_\\infty(B) = |B|\_\\infty |B^{-1}|\_\\infty = 484 \\times \\frac{63}{4} = 7623$。 这是一个非常大的条件数！这意味着这个法方程组是**高度病态 (ill-conditioned)** 的。当多项式的次数 $n$ 稍微再增加一些时，这个条件数会以惊人的速度（指数级）增长。例如，对于10次多项式拟合，条件数可能达到 $10^{13}$ 量级，用标准双精度浮点数求解法方程得到的结果将毫无意义。

**问题的根源是什么？** 根源在于我们选择的基函数——**单项式基** $\\{1, x, x^2, \\dots, x^n\\}$。在大部分区间上（例如$\[0,1\]$），这些函数看起来都非常“相似”，它们不是**正交 (orthogonal)** 的。这导致法方程的系数矩阵 $B\_{kj} = \\sum\_i x\_i^k x\_i^j$ 中，相邻的列向量或行向量变得几乎线性相关，从而导致矩阵的病态。一个典型的例子就是著名的**希尔伯特矩阵 (Hilbert Matrix)**，$H\_{ij} = \\int\_0^1 x^i x^j dx = \\frac{1}{i+j+1}$，它是连续最小二乘问题中使用单项式基时得到的法方程矩阵，以其极端的病态性而臭名昭著。

**出路在何方？** **"Improvement"**: “If we can find a ... set of functions ... that are orthogonal, then the normal matrix will be **diagonal**!” 这就是解决问题的金钥匙。如果我们能找到一组**正交基函数** $\\{\\phi\_0(x), \\phi\_1(x), \\dots, \\phi\_n(x)\\}$ 来表示我们的逼近多项式 $P(x) = \\sum\\limits\_{k=0}^n a\_k \\phi\_k(x)$，那么法方程将会变成一个对角矩阵！求解一个对角方程组易如反掌，病态问题也迎刃而解。

今天，我们将系统地学习：

1.  **函数空间的内积与正交性：** 将线性代数中向量正交的概念推广到函数空间。
2.  **正交多项式：** 学习如何系统地构造一族正交的多项式基函数。
3.  **基于正交基的最小二乘法：** 体验使用正交基是如何将一个病态的、耦合的求解问题，转化为一个简单的、解耦的计算过程。

### **第一部分：函数空间与正交性**

#### **8.2.1 最小二乘问题的推广**

上一讲我们讨论了两种最小二乘问题：

1.  **离散最小二乘：** 给定数据点 $(x\_i, y\_i)$，最小化误差 $E = \\sum\\limits\_{i=1}^m \[P(x\_i)-y\_i\]^2$。
2.  **连续最小二乘：** 给定函数 $f(x)$，最小化误差 $E = \\int\_a^b \[P(x)-f(x)\]^2 dx$。

我们可以进一步推广，引入**权函数 (weight function)** 的概念，允许我们对不同点或不同区间的误差赋予不同的重要性。

**广义最小二乘问题：**

*   **离散形式：** $\\min E = \\sum\\limits\_{i=1}^m w\_i \[P(x\_i)-y\_i\]^2$，其中 $w\_i > 0$。
*   **连续形式：** $\\min E = \\int\_a^b w(x) \[P(x)-f(x)\]^2 dx$，其中 $w(x) \\ge 0$。

#### **8.2.2 函数的内积 (Inner Product)**

为了系统地讨论“正交”，我们需要将向量内积的概念推广到函数空间。

**定义 (函数内积):** 对于定义在区间 $\[a,b\]$ 上的两个函数 $f(x)$ 和 $g(x)$，以及权函数 $w(x)$，我们可以定义它们的**内积**为：

*   **连续情况：** $\\langle f, g \\rangle = \\int\_a^b w(x) f(x) g(x) dx$
*   **离散情况：** $\\langle f, g \\rangle = \\sum\\limits\_{i=1}^m w\_i f(x\_i) g(x\_i)$

这个定义不是随意的，它满足了数学上对内积的所有要求（对称性、线性性、正定性）。

**函数的范数 (Norm) 与正交 (Orthogonality):** 一旦有了内积，我们就可以自然地定义由内积诱导的范数（即函数的“长度”）： $||f|| = \\sqrt{\\langle f, f \\rangle}$

**最小二乘问题的新表述：** 我们的目标变成了最小化 $||P-f||^2$。这正是寻找在由基函数张成的函数子空间中，距离 $f$ **最近**的那个函数 $P$。从几何上看，这等价于将 $f$ **正交投影**到该子空间上。

**定义 (函数正交):** 如果两个函数 $f$ 和 $g$ 的内积为零，$\\langle f, g \\rangle = 0$，则称它们在该内积定义下是**正交的**。

#### **8.2.3 广义多项式与线性无关**

我们的逼近函数 $P(x)$ 通常是一组基函数的线性组合： $$P(x) = \\sum\_{j=0}^n a\_j \\phi\_j(x)$$ 我们称 $P(x)$ 为一个**广义多项式**。${\\phi\_j(x)}$ 是一组**基函数**。

*   如果 $\\phi\_j(x) = x^j$，则 $P(x)$ 是代数多项式。
*   如果 $\\phi\_j(x) = \\cos(jx), \\sin(jx)$，则 $P(x)$ 是三角多项式（傅里叶级数的基础）。
*   如果 $\\phi\_j(x) = e^{k\_j x}$，则 $P(x)$ 是指数多项式。

为了保证系数 $a\_j$ 的唯一性，我们要求基函数集合 $\\{\\phi\_0(x), \\dots, \\phi\_n(x)\\}$ 是**线性无关 (linearly independent)** 的。即，不存在不全为零的系数使得 $\\sum a\_j \\phi\_j(x) = 0$ 在整个定义域上成立。 可以证明，次数不同的单项式 $\\{1, x, \\dots, x^n\\}$ 在任意区间上都是线性无关的。

#### **8.2.4 正交基的巨大优势**

让我们回到最小二乘问题。目标是最小化 $E(a\_0, \\dots, a\_n) = || \\sum\\limits\_{j=0}^n a\_j \\phi\_j - f ||^2$。 通过令 $\\frac{\\partial E}{\\partial a\_k}=0$ (for $k=0, \\dots, n$)，我们得到**一般形式的法方程**： $$\\sum\_{j=0}^n a\_j \\langle \\phi\_k, \\phi\_j \\rangle = \\langle \\phi\_k, f \\rangle$$

其矩阵形式为 $B\\mathbf{a} = \\mathbf{c}$，其中： $$B\_{kj} = \\langle \\phi\_k, \\phi\_j \\rangle$$ $$c\_k = \\langle \\phi\_k, f \\rangle$$

**现在，关键时刻来了！** 如果我们精心选择的基函数 ${\\phi\_k(x)}$ 是**相互正交**的，即： $\\langle \\phi\_k, \\phi\_j \\rangle = 0$, for all $k \\neq j$

那么法方程的系数矩阵 $B$ 将变成一个**对角矩阵**！ $$B\_{kj} = \\begin{cases} \\langle \\phi\_k, \\phi\_k \\rangle = ||\\phi\_k||^2, & \\text{if } k=j \\\\ 0, & \\text{if } k \\neq j \\end{cases}$$

对角方程组的解是平凡的： $$a\_k ||\\phi\_k||^2 = \\langle \\phi\_k, f \\rangle \\implies a\_k = \\frac{\\langle \\phi\_k, f \\rangle}{||\\phi\_k||^2}$$

**结论：** 使用正交基，我们完全**避免了求解一个（可能病态的）线性方程组**。每个系数 $a\_k$ 都可以**独立地、直接地**计算出来！这不仅极大地简化了计算，提高了数值稳定性，还带来了一个美妙的副产品：如果我们想将逼近多项式的次数从 $n$ 提高到 $n+1$，我们只需额外计算系数 $a\_{n+1}$，而之前算好的 $a\_0, \\dots, a\_n$ **保持不变**！

### **第二部分：正交多项式的构造与应用**

我们已经知道了正交基的好处，但问题是：**如何找到一族正交的多项式？**

#### **8.2.5 Gram-Schmidt 正交化过程**

在线性代数中，我们可以用Gram-Schmidt过程将一组线性无关的向量转化为一组正交向量。同样的方法可以应用于函数空间。

我们可以从最简单的单项式基 $\\{1, x, x^2, \\dots\\}$ 出发，通过一个系统性的过程来构造一族正交多项式 $\\{\\phi\_0, \\phi\_1, \\phi\_2, \\dots\\}$。

**三项递推关系 (Three-Term Recurrence Relation):** 对于大部分经典的权函数，通过Gram-Schmidt过程构造出的正交多项式都满足一个简单的三项递推关系： $\\phi\_k(x) = (x-B\_k)\\phi\_{k-1}(x) - C\_k\\phi\_{k-2}(x)$, for $k \\ge 2$. 其中 $\\phi\_0(x)=1$, $\\phi\_1(x) = x - B\_1$。 递推系数 $B\_k$ 和 $C\_k$ 可以由内积算出： $$B\_k = \\frac{\\langle x\\phi\_{k-1}, \\phi\_{k-1} \\rangle}{||\\phi\_{k-1}||^2}$$ $$C\_k = \\frac{\\langle x\\phi\_{k-1}, \\phi\_{k-2} \\rangle}{||\\phi\_{k-2}||^2}$$

这个递推关系使得我们能够非常高效地生成任意阶的正交多项式，而无需执行完整的Gram-Schmidt过程。

**一些著名的正交多项式族：**

*   **勒让德多项式 (Legendre Polynomials):** 在 $\[-1,1\]$ 上关于权函数 $w(x)=1$ 正交。
*   **切比雪夫多项式 (Chebyshev Polynomials):** 在 $\[-1,1\]$ 上关于权函数 $w(x)=1/\\sqrt{1-x^2}$ 正交。它们在缓解龙格现象中起关键作用。
*   **拉盖尔多项式 (Laguerre Polynomials):** 在 $\[0, \\infty)$ 上关于权函数 $w(x)=e^{-x}$ 正交。
*   **埃尔米特多项式 (Hermite Polynomials):** 在 $(-\\infty, \\infty)$ 上关于权函数 $w(x)=e^{-x^2}$ 正交。

#### **8.2.6 案例研究：用正交多项式重解拟合问题**

让我们用正交化的方法重新解决 (Discussion 22) 的问题。 **数据：** $x=\\{1,2,3,4\\}$, $y=\\{4,10,18,26\\}$, $w\_i=1$ (离散内积)。 **目标：** 拟合 $y \\approx a\_0\\phi\_0(x) + a\_1\\phi\_1(x) + a\_2\\phi\_2(x)$。

**Step 1: 构造正交多项式**

*   **$\\phi\_0(x) = 1$**
    
    *   $\\langle \\phi\_0, \\phi\_0 \\rangle = \\sum\_i 1^2 = 4$
    *   $\\langle x\\phi\_0, \\phi\_0 \\rangle = \\sum\_i x\_i \\cdot 1^2 = 1+2+3+4 = 10$
*   **$\\phi\_1(x) = x - B\_1$**
    
    *   $B\_1 = \\frac{\\langle x\\phi\_0, \\phi\_0 \\rangle}{||\\phi\_0||^2} = \\frac{10}{4} = 2.5$
    *   $\\phi\_1(x) = x - 2.5$
    *   $\\langle \\phi\_1, \\phi\_1 \\rangle = \\sum\_i (x\_i-2.5)^2 = (-1.5)^2+(-0.5)^2+(0.5)^2+(1.5)^2 = 5$
    *   $\\langle x\\phi\_1, \\phi\_1 \\rangle = \\sum\_i x\_i (x\_i-2.5)^2 = 1(-1.5)^2+\\dots+4(1.5)^2 = 25$
*   **$\\phi\_2(x) = (x-B\_2)\\phi\_1(x) - C\_2\\phi\_0(x)$**
    
    *   $B\_2 = \\frac{\\langle x\\phi\_1, \\phi\_1 \\rangle}{||\\phi\_1||^2} = \\frac{25}{5} = 5$
    *   $C\_2 = \\frac{\\langle x\\phi\_1, \\phi\_0 \\rangle}{||\\phi\_0||^2} = \\frac{\\langle \\phi\_1, x\\phi\_0 \\rangle}{||\\phi\_0||^2} = \\frac{\\langle \\phi\_1, \\phi\_1+B\_1\\phi\_0 \\rangle}{||\\phi\_0||^2} = \\frac{||\\phi\_1||^2}{||\\phi\_0||^2} = \\frac{5}{4} = 1.25$
    *   $\\phi\_2(x) = (x-5)(x-2.5) - 1.25 = x^2 - 7.5x + 11.25$

**Step 2: 计算系数**

*   $\\langle \\phi\_0, y \\rangle = \\sum\_i y\_i = 4+10+18+26 = 58$
    
*   $\\langle \\phi\_1, y \\rangle = \\sum\_i (x\_i-2.5)y\_i = (-1.5)(4)+\\dots+(1.5)(26) = 37$
    
*   $\\langle \\phi\_2, y \\rangle = \\sum\_i (x\_i^2-7.5x\_i+11.25)y\_i = \\dots = -2$
    
*   $a\_0 = \\frac{\\langle \\phi\_0, y \\rangle}{||\\phi\_0||^2} = \\frac{58}{4} = 14.5$
    
*   $a\_1 = \\frac{\\langle \\phi\_1, y \\rangle}{||\\phi\_1||^2} = \\frac{37}{5} = 7.4$
    
*   $a\_2 = \\frac{\\langle \\phi\_2, y \\rangle}{||\\phi\_2||^2} = \\frac{-2}{4} = -0.5$ (注： $||\\phi\_2||^2=\\sum\_i \\phi\_2(x\_i)^2 = 4$)
    

**Step 3: 组合得到最终多项式** $P(x) = 14.5 \\cdot (1) + 7.4 \\cdot (x-2.5) - 0.5 \\cdot (x^2 - 7.5x + 11.25)$ $P(x) = (14.5 - 18.5 - 5.625) + (7.4 + 3.75)x - 0.5x^2$ $P(x) = -9.625 + 11.15x - 0.5x^2$

**关键对比：**

*   **直接法：** 建立并求解一个3x3的**病态**稠密线性系统。
*   **正交法：** 只需计算一系列**内积**（求和），然后做几次除法。完全没有矩阵求逆或解方程的过程，数值稳定性极佳。

### **课程总结**

**本讲核心要点：**

1.  **最小二乘法的病态性：** 使用标准的单项式基 $\\{1, x, \\dots, x^n\\}$ 会导致法方程的系数矩阵（希尔伯特矩阵的离散模拟）高度病态，使得高次多项式拟合在数值上不可行。
2.  **函数空间内积与正交性：** 我们可以将向量空间中的内积、范数和正交概念推广到函数空间，为解决上述病态问题提供了强大的理论工具。
3.  **正交基的魔力：** 如果使用一族正交的基函数 ${\\phi\_k(x)}$ 来进行最小二乘逼近，复杂的法方程组会退化为一个简单的对角系统。这使得系数可以独立、稳定、高效地求出。
4.  **正交多项式的构造：** 我们可以通过 Gram-Schmidt 过程或更高效的三项递推关系来系统地构造出满足任意内积（离散或连续）定义下的正交多项式族。