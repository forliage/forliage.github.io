---
title: "数值分析12:高斯求积与常微分方程初值问题"
description: ""
pubDate: "2025-08-27"
heroImage: ""
---

# 数值分析12:高斯求积与常微分方程初值问题

### **引言：从被动采样到主动寻优，从静态问题到动态模拟**

在过去的几讲中，我们的旅程主要集中在**静态**的数学问题上：求解一个代数方程，拟合一组数据，计算一个定积分。今天，我们的课程将分为两个激动人心的部分，分别代表着数值分析中两种思想的巅峰，并引领我们从静态问题走向动态模拟。

**第一部分：高斯求积 (Gaussian Quadrature)**

我们已经学习了**牛顿-柯特斯 (Newton-Cotes)** 系列的数值积分公式，如梯形法则和辛普森法则。它们的核心思想是：**先固定积分节点 (通常是等距的)，然后推导出对应的权重**，使得公式对尽可能高次的多项式精确。这种方法就像是被动地接受给定的采样点，然后尽力做到最好。

这就引出了一个深刻的问题：**如果我们被赋予更大的自由度，不仅可以设计权重 (weights)，还可以主动选择积分节点 (nodes) 的位置，我们能否构造出“更强大”的求积公式？**

答案是肯定的，而且结果令人惊叹。通过巧妙地选择积分节点的位置，我们可以让一个仅使用 $n+1$ 个点的求积公式，其**精度 (Degree of Precision)** 达到惊人的 $2n+1$！这几乎是牛顿-柯特斯公式的两倍。这就是**高斯求积**的魔力。我们将揭示，这些“神奇”的积分节点，正是我们在前面章节学习的**正交多项式**的根。这一部分的学习，将是之前逼近理论和正交多项式知识的完美应用和升华。

**第二部分：常微分方程初值问题 (Initial-Value Problems for ODEs)**

课程的第二部分，我们将开启一个全新的、也是数值分析应用最广泛的领域。现实世界充满了**变化**：物体的运动、人口的增长、电路中电流的变化、化学反应的进程……所有这些动态过程，在数学上都由**微分方程**来描述。

我们将聚焦于最基本的一类问题——**一阶常微分方程初值问题 (IVP)**： $$\\frac{dy}{dt} = f(t,y), \\quad y(a)=\\alpha$$ 给定系统在初始时刻 $a$ 的状态 $\\alpha$，我们希望预测它在未来时刻 $t>a$ 的状态 $y(t)$。

除了极少数情况，绝大多数微分方程无法求出解析解。因此，我们必须依赖**数值方法**。数值方法的核心思想是“**步进 (Stepping)**”：从已知的初始点 $(t\_0, y\_0)$ 出发，像“摸着石头过河”一样，一步一步地近似计算出序列点 $(t\_1, w\_1), (t\_2, w\_2), \\dots$，其中 $w\_i \\approx y(t\_i)$。

今天，我们将从最基础的**欧拉方法 (Euler's Method)** 入手，深入分析其思想、推导、误差以及稳定性。这将为我们后续学习更高级、更强大的ODE求解器（如龙格-库塔法）奠定坚实的理论基础。我们将探讨：

*   一个ODE问题要“值得解”，需要满足哪些数学条件（**适定性 Well-posedness**）？
*   数值方法的**局部截断误差**和**全局误差**有何区别与联系？
*   为什么显式方法简单却有稳定性的烦恼，而隐式方法复杂却更稳健？

### **第一部分：高斯求积**

#### **4.7.1 Newton-Cotes 公式的局限与新思路**

回顾牛顿-柯特斯公式 $\\int\_a^b f(x)dx \\approx \\sum\\limits\_{k=0}^n A\_k f(x\_k)$，我们有 $n+1$ 个自由度（即权重 $A\_0, \\dots, A\_n$），因为节点 $x\_k$ 是预先固定的。这 $n+1$ 个自由度让我们构造的公式精度最高能达到 $n$（如果 $n$ 是奇数）或 $n+1$（如果 $n$ 是偶数）。

**高斯求积的核心思想：** 如果我们把**节点 $x\_0, \\dots, x\_n$** 和**权重 $A\_0, \\dots, A\_n$** **全部**看作是待定的未知数，那么我们总共有 **$2n+2$ 个自由度**！ "Determine $2n+2$ unknowns ... such that the formula is accurate for $f(x)=1, x, x^2, \\dots, x^{2n+1}$."

我们的目标是利用这 $2n+2$ 个自由度，构造一个求积公式，使其能精确地对所有次数不超过 $2n+1$ 的多项式积分。即，我们追求的**精度高达 $2n+1$**。

**一个简单的例子 (Discussion 31):** 求 $\\int\_0^1 \\sqrt{x}f(x)dx \\approx A\_0 f(x\_0) + A\_1 f(x\_1)$ ($n=1$，两个点)。 我们有4个未知数：$x\_0, x\_1, A\_0, A\_1$。 我们要求它对 $f(x)=1, x, x^2, x^3$ 都精确。权函数是 $w(x)=\\sqrt{x}$。

1.  $f(x)=1: \\int\_0^1 \\sqrt{x} dx = \\frac{2}{3} = A\_0 + A\_1$
2.  $f(x)=x: \\int\_0^1 \\sqrt{x} \\cdot x dx = \\frac{2}{5} = A\_0 x\_0 + A\_1 x\_1$
3.  $f(x)=x^2: \\int\_0^1 \\sqrt{x} \\cdot x^2 dx = \\frac{2}{7} = A\_0 x\_0^2 + A\_1 x\_1^2$
4.  $f(x)=x^3: \\int\_0^1 \\sqrt{x} \\cdot x^3 dx = \\frac{2}{9} = A\_0 x\_0^3 + A\_1 x\_1^3$

这是一个关于 $x\_0, x\_1, A\_0, A\_1$ 的**非线性方程组**！"Nonlinear!" 直接求解这个方程组非常困难。我们需要一个更系统、更具构造性的方法。

#### **4.7.2 高斯节点与正交多项式的深刻联系**

**关键定理：** 求积公式 $\\int\_a^b w(x)f(x)dx \\approx \\sum\\limits\_{k=0}^n A\_k f(x\_k)$ 的精度为 $2n+1$ 的**充分必要条件**是：节点 $x\_0, \\dots, x\_n$ 是**关于权函数 $w(x)$ 和区间 $\[a,b\]$ 的 $(n+1)$ 阶正交多项式 $\\phi\_{n+1}(x)$ 的根**。

**证明思路 (简述):** ($\\Leftarrow$) **如果节点是正交多项式的根，则精度为 $2n+1$。**

*   设 $P\_{2n+1}(x)$ 是任意一个次数 $\\le 2n+1$ 的多项式。
*   用 $\\phi\_{n+1}(x)$ 去除 $P\_{2n+1}(x)$，得到商 $q(x)$ 和余数 $r(x)$，它们的次数都 $\\le n$。 $$P\_{2n+1}(x) = \\phi\_{n+1}(x)q(x) + r(x)$$
*   对 $P\_{2n+1}(x)$ 积分： $$\\int\_a^b w(x) P\_{2n+1}(x) dx = \\int\_a^b w(x)\\phi\_{n+1}(x)q(x)dx + \\int\_a^b w(x)r(x)dx$$ 由于 $\\phi\_{n+1}$ 与所有次数 $\\le n$ 的多项式（包括 $q(x)$）都正交，第一项积分为0！ 所以，$$\\int\_a^b w(x) P\_{2n+1}(x) dx = \\int\_a^b w(x)r(x)dx$$
*   将 $P\_{2n+1}(x)$ 代入求积公式： $$\\sum\_{k=0}^n A\_k P\_{2n+1}(x\_k) = \\sum A\_k (\\phi\_{n+1}(x\_k)q(x\_k) + r(x\_k))$$ 因为 $x\_k$ 是 $\\phi\_{n+1}$ 的根，所以 $\\phi\_{n+1}(x\_k)=0$。 $$\\sum A\_k P\_{2n+1}(x\_k) = \\sum A\_k r(x\_k)$$
*   由于我们的求积公式是通过对次数 $\\le n$ 的插值多项式积分构造的（权重 $A\_k = \\int\_a^b w(x) L\_k(x)dx$），它对所有次数 $\\le n$ 的多项式（包括 $r(x)$）都是**精确**的！ 所以 $$\\int\_a^b w(x)r(x)dx = \\sum A\_k r(x\_k)$$
*   结合以上，我们证明了 $\\int\_a^b w(x) P\_{2n+1}(x) dx = \\sum A\_k P\_{2n+1}(x\_k)$。证毕。

**高斯求积的构造步骤：**

1.  **确定正交多项式族：** 根据积分区间 $\[a,b\]$ 和权函数 $w(x)$，确定对应的正交多项式族（如勒让德、切比雪夫等）。
2.  **寻找高斯节点：** 求解 $n+1$ 阶正交多项式 $\\phi\_{n+1}(x)=0$ 的根，得到 $x\_0, \\dots, x\_n$。可以证明，这些根都是在 $(a,b)$ 内的实根。
3.  **计算权重：** 通过公式 $A\_k = \\int\_a^b w(x) L\_k(x)dx$ 计算权重。对于经典的正交多项式族，这些权重有简洁的解析表达式。
4.  **应用公式：** 使用 $\\int\_a^b w(x)f(x)dx \\approx \\sum\_{k=0}^n A\_k f(x\_k)$。

**经典的高斯求积公式：**

*   **Gauss-Legendre Quadrature:**
    *   区间: $\[-1,1\]$, 权函数: $w(x)=1$。
    *   节点: $(n+1)$ 阶勒让德多项式 $P\_{n+1}(x)$ 的根。
    *   应用：最通用的高精度数值积分方法。
*   **Gauss-Chebyshev Quadrature:**
    *   区间: $\[-1,1\]$, 权函数: $w(x)=1/\\sqrt{1-x^2}$。
    *   节点: $x\_k = \\cos(\\frac{2k+1}{2n+2}\\pi)$ (非常容易计算!)
    *   权重: $A\_k = \\pi/(n+1)$ (所有权重都相等!)
    *   应用：处理端点有 $1/\\sqrt{1-x^2}$ 型奇性的积分。

**结论：** 高斯求积通过牺牲节点选择的简便性（不再是等距），换来了无与伦比的精度。对于光滑的被积函数，它通常是最高效的数值积分方法。

### **第二部分：常微分方程初值问题**

#### **5.1 问题的数学框架**

我们研究形如 $\\frac{dy}{dt} = f(t,y), a \\le t \\le b, y(a)=\\alpha$ 的初值问题。 在投入计算资源之前，我们必须确保这个问题是“值得解的”。

**定义 (适定性 - Well-Posed Problem):** 一个初值问题是适定的，如果：

1.  **解存在且唯一。**
2.  **解对初始条件是连续依赖的：** 初始条件 $\\alpha$ 或函数 $f(t,y)$ 的微小扰动，只会导致解 $y(t)$ 的微小变化。

**Lipschitz 条件：** 保证解存在且唯一的关键条件是 **Lipschitz 条件**。 函数 $f(t,y)$ 在变量 $y$ 上满足 Lipschitz 条件，如果存在一个常数 $L>0$ (Lipschitz 常数)，使得： $$|f(t, y\_1) - f(t, y\_2)| \\le L|y\_1 - y\_2|$$ 对于定义域内的任意两点 $(t, y\_1)$ 和 $(t, y\_2)$。 直观上，这个条件限制了函数 $f$ 沿 $y$ 方向的变化率不能是无限的。如果 $\\frac{\\partial f}{\\partial y}$ 存在且有界，那么 $f$ 一定满足Lipschitz条件。

**存在唯一性与适定性定理：** 如果 $f(t,y)$ 在其定义域上连续，并且在变量 $y$ 上满足 Lipschitz 条件，那么该初值问题是**适定的**。

#### **5.2 欧拉方法 (Euler's Method)**

这是最简单、最直观的数值方法。 **推导1：泰勒展开** 将真解 $y(t\_{i+1})$ 在 $t\_i$ 处进行一阶泰勒展开： $y(t\_{i+1}) = y(t\_i) + y'(t\_i)(t\_{i+1}-t\_i) + \\frac{y''(\\xi\_i)}{2}(t\_{i+1}-t\_i)^2$ 令 $h = t\_{i+1}-t\_i$，并注意到 $y'(t\_i) = f(t\_i, y(t\_i))$。忽略二阶及以上的项，并用近似值 $w\_i \\approx y(t\_i)$ 代替，我们得到： $$w\_{i+1} = w\_i + h f(t\_i, w\_i)$$

**推导2：前向差分** 用前向差分近似导数：$\\frac{y(t\_{i+1})-y(t\_i)}{h} \\approx y'(t\_i) = f(t\_i, y(t\_i))$。 整理后得到相同的迭代格式。

**欧拉方法迭代公式：** $w\_0 = \\alpha$ $w\_{i+1} = w\_i + h f(t\_i, w\_i), \\quad \\text{for } i=0, 1, \\dots, n-1$.

几何上，欧拉方法就是从点 $(t\_i, w\_i)$ 出发，沿着由 $f(t\_i, w\_i)$ 给出的“方向场”（即切线斜率），前进一个步长 $h$，到达下一个点 $(t\_{i+1}, w\_{i+1})$。

#### **5.2.1 误差分析：局部与全局**

**局部截断误差 (Local Truncation Error, LTE):** LTE 是衡量数值方法**一步**之内引入的误差。它假设我们从一个**精确的点** $(t\_i, y(t\_i))$ 出发，走一步后与真解 $y(t\_{i+1})$ 的差距。 $$\\tau\_{i+1}(h) = \\frac{y(t\_{i+1}) - (y(t\_i) + h f(t\_i, y(t\_i)))}{h} = \\frac{h}{2}y''(\\xi\_i) = O(h)$$ 欧拉方法是一个**一阶方法**，因为其LTE是 $O(h)$。

**全局截断误差 (Global Truncation Error):** 全局误差是我们在 $t\_i$ 点的计算值 $w\_i$ 与真解 $y(t\_i)$ 之间的总差距 $|y(t\_i) - w\_i|$。这个误差是之前所有步的局部截断误差**累积**的结果。 可以证明，对于一个适定的问题，如果一个方法的局部截断误差是 $O(h^p)$，那么它的全局截断误差就是 $O(h^p)$。 因此，欧拉方法的全局误差是 $O(h)$。

**误差界：** **定理：** 对于一个满足Lipschitz条件的问题，欧拉方法的全局误差满足： $$|y(t\_i) - w\_i| \\le \\frac{Mh}{2L} \[e^{L(t\_i-a)} - 1\]$$ 其中 $M$ 是 $|y''(t)|$ 的上界，$L$ 是 Lipschitz 常数。 这个公式虽然不便于实际计算，但它深刻地揭示了：

*   误差与步长 $h$ 成正比（一阶）。
*   误差随积分时间 $t\_i$ 呈指数增长（由 $e^{L(t\_i-a)}$ 项决定）。$L$ 越大，误差累积越快。

#### **5.3 高阶泰勒方法**

为了提高精度，我们可以自然地想到在泰勒展开中保留更多项。 一个 **$n$ 阶泰勒方法**的迭代格式为： $$w\_{i+1} = w\_i + h T^{(n)}(t\_i, w\_i)$$ 其中 $T^{(n)}(t\_i, w\_i) = f(t\_i, w\_i) + \\frac{h}{2}f'(t\_i, w\_i) + \\dots + \\frac{h^{n-1}}{n!}f^{(n-1)}(t\_i, w\_i)$。 这里的 $f', f'', \\dots$ 是对 $y'(t)=f(t,y(t))$ 这个复合函数关于 $t$ 的全导数，需要用到链式法则，例如： $$f'(t,y) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial y} \\frac{dy}{dt} = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial y} f(t,y)$$

$n$ 阶泰勒方法的局部截断误差是 $O(h^n)$，全局误差也是 $O(h^n)$。 **优点：** 精度高。 **缺点：** 需要计算 $f$ 的高阶偏导数，对于复杂的函数 $f$ 来说，这会变得极其繁琐和容易出错。因此，高阶泰勒方法在实践中很少直接使用。

#### **5.3.1 隐式方法简介**

欧拉方法被称为**显式 (Explicit)** 方法，因为 $w\_{i+1}$ 的计算公式完全由已知的 $t\_i, w\_i$ 决定。 **隐式欧拉法 (Implicit Euler's Method):** 如果我们用后向差分来近似导数 $\\frac{y(t\_i)-y(t\_{i-1})}{h} \\approx y'(t\_i)$，我们会得到： $$w\_{i+1} = w\_i + h f(t\_{i+1}, w\_{i+1})$$ 这是一个**隐式 (Implicit)** 方法，因为未知的 $w\_{i+1}$ 同时出现在方程的两边！为了求解 $w\_{i+1}$，我们通常需要使用求根算法（如不动点迭代或牛顿法）。

**为什么需要隐式方法？**

*   **更好的稳定性：** 对于某些“刚性 (stiff)”问题，显式方法的步长 $h$ 会受到极大的限制才能保持稳定，而隐式方法可以用大得多的步长进行稳定计算。
*   **更高的精度 (有时):** 例如，将显式和隐式欧拉法平均，可以得到**梯形法**，这是一个二阶精度的隐式方法。

### **课程总结**

**本讲核心要点：**

1.  **高斯求积**通过同时优化**节点**和**权重**，实现了用 $n+1$ 个点达到 $2n+1$ 的精度，是最高效的数值积分方法之一。其节点是相应正交多项式的根。
2.  **常微分方程初值问题**是模拟动态系统的基本数学模型。其**适定性**（解的存在、唯一、稳定）由**Lipschitz条件**保证。
3.  **欧拉方法**是最基础的ODE数值解法，通过泰勒展开或差分近似推导。它是一个**一阶方法**，即局部和全局误差都是 $O(h)$。
4.  **高阶泰勒方法**可以提高精度，但需要计算 $f$ 的复杂高阶导数，实用性不强。
5.  数值方法分为**显式**和**隐式**两类。显式方法计算简单，但稳定性受限；隐式方法计算复杂，但通常具有更好的稳定性。