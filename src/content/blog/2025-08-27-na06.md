---
title: "数值分析06:线性系统的误差分析与多项式插值"
description: ""
pubDate: "2025-08-27"
heroImage: ""
---

# 数值分析06:线性系统的误差分析与多项式插值

### **引言：问题的敏感性与函数的近似**

在前几讲中，我们投入了大量精力学习如何求解方程组，包括直接法（高斯消元、LU分解）和迭代法（Jacobi, Gauss-Seidel, SOR）。我们关注算法的**效率**（计算量）、**鲁棒性**（主元选择）和**收敛性**（谱半径）。

至今为止，我们暗中作了一个理想化的假设：**输入的矩阵 $A$ 和向量 $\\mathbf{b}$ 是完全精确的。** 在现实世界中，这几乎是不可能的。输入数据往往来源于测量（带有测量误差）或前一步的计算（带有舍入误差）。

这就引出了一个至关重要的问题：**如果输入数据有微小的误差，我们求出的解 $\\mathbf{x}$ 会有多大的误差？** 这个问题与算法无关，而是关乎**问题本身**的“好坏”或“敏感性”。一个微小的输入扰动导致输出巨大变化的问题，我们称之为**病态 (ill-conditioned)** 问题。衡量这种敏感性的工具，就是我们今天要讲的第一个核心概念——**条件数 (Condition Number)**。

课程的第二部分，我们将切换到一个全新的，但同样是数值分析基石的领域。在科学计算中，我们经常遇到这样一些情况：

1.  我们不知道一个函数的具体表达式，只知道它在一系列离散点上的函数值（例如，通过实验测量得到的数据）。
2.  我们知道函数的表达式，但它过于复杂，不便于求导、积分或进一步的计算（例如 $f(x) = \\int\_0^x e^{-t^2} dt$）。

面对这些情况，我们的核心策略是：**用一个简单的、我们熟知的函数（通常是多项式）来近似或“代替”这个未知的或复杂的函数。** 这个过程就是**插值 (Interpolation)**。今天，我们将学习最经典的多项式插值方法——**拉格朗日多项式插值**，并分析其近似效果。

### **第一部分：误差界与条件数**

#### **7.4.1 问题的提出**

我们考虑线性系统 $A\\mathbf{x} = \\mathbf{b}$。假设由于某种原因，我们的输入存在扰动，求解的是一个略有不同的系统。我们将分析两种情况。

**研究课题6: 扰动分析**

1.  **右端项 $\\mathbf{b}$ 的扰动：** 假设 $A$ 精确，但 $\\mathbf{b}$ 有误差 $\\delta\\mathbf{b}$。我们实际求解的是 $A(\\mathbf{x}+\\delta\\mathbf{x}) = \\mathbf{b}+\\delta\\mathbf{b}$。我们想知道解的相对误差 $\\frac{|\\delta\\mathbf{x}|}{|\\mathbf{x}|}$ 和数据相对误差 $\\frac{|\\delta\\mathbf{b}|}{|\\mathbf{b}|}$ 之间的关系。
2.  **系数矩阵 $A$ 的扰动：** 假设 $\\mathbf{b}$ 精确，但 $A$ 有误差 $\\delta A$。我们实际求解的是 $(A+\\delta A)(\\mathbf{x}+\\delta\\mathbf{x}) = \\mathbf{b}$。这两种情况的分析是数值线性代数稳定性的核心。

#### **7.4.2 右端项扰动分析**

从 $A(\\mathbf{x}+\\delta\\mathbf{x}) = \\mathbf{b}+\\delta\\mathbf{b}$ 和 $A\\mathbf{x} = \\mathbf{b}$ 两式相减，得到： $A\\delta\\mathbf{x} = \\delta\\mathbf{b} \\implies \\delta\\mathbf{x} = A^{-1}\\delta\\mathbf{b}$

现在我们引入范数来衡量误差的大小。使用任意相容的向量和矩阵范数： $|\\delta\\mathbf{x}| = |A^{-1}\\delta\\mathbf{b}| \\le |A^{-1}| |\\delta\\mathbf{b}|$

为了得到相对误差，我们还需要 $|\\mathbf{x}|$ 的一个下界。从 $A\\mathbf{x} = \\mathbf{b}$ 可得： $|\\mathbf{b}| = |A\\mathbf{x}| \\le |A| |\\mathbf{x}| \\implies |\\mathbf{x}| \\ge \\frac{|\\mathbf{b}|}{|A|}$ (假设 $\\mathbf{b}\\neq \\mathbf{0}$)

将这两个不等式组合起来： $\\frac{|\\delta\\mathbf{x}|}{|\\mathbf{x}|} \\le \\frac{|A^{-1}| |\\delta\\mathbf{b}|}{|\\mathbf{b}| / |A|} = (|A||A^{-1}|) \\frac{|\\delta\\mathbf{b}|}{|\\mathbf{b}|}$

这个结果极为重要。它表明，解的相对误差被右端项的相对误差放大了，其放大系数正是括号中的那一项。

#### **7.4.3 条件数 (Condition Number)**

**定义：** 对于一个非奇异矩阵 $A$，其**条件数** $K(A)$ 定义为： $K(A) = |A| |A^{-1}|$

使用这个定义，上面的误差界可以写成： $\\frac{|\\delta\\mathbf{x}|}{|\\mathbf{x}|} \\le K(A) \\frac{|\\delta\\mathbf{b}|}{|\\mathbf{b}|}$

**条件数的意义：**

*   **误差放大器：** 条件数是衡量线性系统 $A\\mathbf{x}=\\mathbf{b}$ 对右端项 $\\mathbf{b}$ 扰动的**敏感度**的指标。
*   **$K(A)$ 很大 (>> 1):** 系统是**病态的 (ill-conditioned)**。这意味着即使 $\\mathbf{b}$ 中一个非常小的相对误差，也可能导致解 $\\mathbf{x}$ 中一个巨大的相对误差。在这种情况下，即使使用数值上最稳定的算法，得到的解也可能是不可靠的。
*   **$K(A)$ 很小 (接近 1):** 系统是**良态的 (well-conditioned)**。解的相对误差与数据的相对误差在同一个数量级。

**条件数的重要性质：**

1.  **$K(A) \\ge 1$** for any natural norm。（因为 $1 = |I| = |AA^{-1}| \\le |A||A^{-1}| = K(A)$）
2.  对于对称矩阵，谱条件数 $K\_2(A) = \\frac{|\\lambda\_{\\max}|}{|\\lambda\_{\\min}|}$，即最大和最小特征值绝对值之比。
3.  对于正交矩阵 $Q$ ($Q^{-1}=Q^T$)， $K\_2(Q)=1$。这是条件数能达到的最小值，正交矩阵对应的系统是数值上最理想的。
4.  $K(\\alpha A) = K(A)$ for any scalar $\\alpha \\neq 0$。条件数与矩阵的尺度无关。

#### **7.4.4 矩阵 $A$ 的扰动分析**

当矩阵 $A$ 存在扰动 $\\delta A$ 时，分析更为复杂。可以证明（假设 $|\\delta A| < 1/|A^{-1}|$ 以保证 $A+\\delta A$ 非奇异），我们有如下误差界： $\\frac{|\\delta\\mathbf{x}|}{|\\mathbf{x}+\\delta\\mathbf{x}|} \\le K(A) \\frac{|\\delta A|}{|A|}$ （注意这里的解的相对误差分母是扰动后的解 $\\mathbf{x}+\\delta\\mathbf{x}$） 这同样表明，条件数 $K(A)$ 也控制着系统对系数矩阵 $A$ 扰动的敏感度。

**综合误差界：** 当 $A$ 和 $\\mathbf{b}$ 同时存在扰动时，有如下定理： **定理：** 假设 $A$ 非奇异且 $K(A)\\frac{|\\delta A|}{|A|} < 1$，则 $\\frac{|\\delta\\mathbf{x}|}{|\\mathbf{x}|} \\le \\frac{K(A)}{1 - K(A)\\frac{|\\delta A|}{|A|}} \\left( \\frac{|\\delta A|}{|A|} + \\frac{|\\delta\\mathbf{b}|}{|\\mathbf{b}|} \\right)$

这个公式是数值线性代数的**核心结果**之一。它精确地量化了输入数据的相对误差是如何通过条件数被放大，并最终体现在解的相对误差中。

**Discussion 15: 一个病态系统的例子** 给定 $A = \\begin{pmatrix} 1 & 0.99 \\\\ 0.99 & 0.98 \\end{pmatrix}$。 这是一个对称矩阵，其特征值为 $\\lambda\_1 \\approx 1.98$ 和 $\\lambda\_2 \\approx -0.00005$。 谱条件数为 $K\_2(A) = \\frac{|\\lambda\_1|}{|\\lambda\_2|} \\approx 39206 \\gg 1$。这是一个**高度病态**的矩阵。 即使我们给右端项一个小于 $0.01%$ 的微小扰动，最终解的相对误差却超过了 $200%$！ **结论：** 对于病态系统，解的精度损失是**不可避免**的，这是问题本身的特性，而非算法的过错。我们能做的就是：

1.  识别病态问题（通过估算条件数）。
2.  尽可能提高计算精度（例如使用双精度甚至更高精度）。
3.  如果可能，从问题建模的角度重新构造方程，以降低条件数。

#### **7.4.5 迭代改善 (Iterative Refinement)**

如果我们用直接法（如LU分解）得到了一个解 $\\mathbf{x}^{(0)}$，但由于病态性或舍入误差，它不够精确，我们能做什么？ **迭代改善**提供了一种修正解的有效方法。

1.  **计算残差 (Compute Residual):** $\\mathbf{r}^{(0)} = \\mathbf{b} - A\\mathbf{x}^{(0)}$ **关键：** 这一步必须用**更高精度**（例如双精度）的算术来计算，以避免相近数相减的误差完全淹没真实的残差信息。
2.  **求解误差方程 (Solve for Error):** 真实解 $\\mathbf{x}$ 满足 $A\\mathbf{x} = \\mathbf{b}$。令 $\\mathbf{x} = \\mathbf{x}^{(0)} + \\delta\\mathbf{x}$，则 $A(\\mathbf{x}^{(0)} + \\delta\\mathbf{x}) = \\mathbf{b}$，即 $A\\delta\\mathbf{x} = \\mathbf{b} - A\\mathbf{x}^{(0)} = \\mathbf{r}^{(0)}$。 我们现在求解关于误差修正量 $\\delta\\mathbf{x}$ 的线性系统 $A\\delta\\mathbf{x} = \\mathbf{r}^{(0)}$。由于我们已经有了 $A$ 的 LU 分解，这一步非常快，只需 $O(n^2)$ 的计算。
3.  **修正解 (Correct the Solution):** $\\mathbf{x}^{(1)} = \\mathbf{x}^{(0)} + \\delta\\mathbf{x}^{(0)}$

这个过程可以重复进行，直到解的精度不再显著提高。迭代改善是一种非常廉价而有效的方法，可以将一个中等精度的解提升到机器精度所允许的最高水平。

### **第二部分：插值与拉格朗日多项式**

#### **3.0 插值的基本概念**

**问题背景：** 我们有一组离散的数据点 $(x\_0, y\_0), (x\_1, y\_1), \\dots, (x\_n, y\_n)$，其中 $y\_i = f(x\_i)$。我们希望找到一个**简单的函数 $P(x)$**，它能够**穿过**所有这些数据点，即满足**插值条件**： $P(x\_i) = y\_i$, for $i=0, 1, \\dots, n$.

我们称 $P(x)$ 为 $f(x)$ 在节点 $x\_0, \\dots, x\_n$ 上的**插值函数**。

**为什么选择多项式？** 多项式 $P(x) = a\_n x^n + \\dots + a\_1 x + a\_0$ 具有许多优良性质：

*   它们在任意点都无穷次可微，性质良好。
*   它们的求导和积分非常容易，结果仍然是多项式。
*   **魏尔斯特拉斯逼近定理 (Weierstrass Approximation Theorem)** 保证了任何定义在闭区间上的连续函数，都可以被多项式以任意精度一致逼近。

#### **3.1 拉格朗日插值多项式**

**目标：** 给定 $n+1$ 个数据点 $(x\_0, y\_0), \\dots, (x\_n, y\_n)$（其中所有 $x\_i$ 互不相同），找到一个**次数最高为 $n$** 的多项式 $P\_n(x)$，满足插值条件。

**构造思想：** 我们不直接去求系数 $a\_i$，而是采用一种更具构造性的方法。我们将 $P\_n(x)$ 写成一种线性组合的形式： $P\_n(x) = y\_0 L\_{n,0}(x) + y\_1 L\_{n,1}(x) + \\dots + y\_n L\_{n,n}(x) = \\sum\_{i=0}^n y\_i L\_{n,i}(x)$ 其中，$L\_{n,i}(x)$ 是一组多项式，称为**拉格朗日基函数 (Lagrange Basis Polynomials)**。

为了让 $P\_n(x\_j) = y\_j$ 成立，我们对基函数 $L\_{n,i}(x)$ 提出一个巧妙的要求： $L\_{n,i}(x\_j) = \\delta\_{ij} = \\begin{cases} 1, & \\text{if } j=i \\\\ 0, & \\text{if } j \\neq i \\end{cases}$ ($\\delta\_{ij}$ 是克罗内克符号) 如果基函数满足这个性质，那么当 $x=x\_j$ 时，求和式中只有第 $j$ 项 $y\_j L\_{n,j}(x\_j)$ 非零，且等于 $y\_j \\cdot 1 = y\_j$，插值条件自然满足。

**构造基函数 $L\_{n,i}(x)$:**

*   为了让 $L\_{n,i}(x\_j)=0$ 对于所有 $j \\neq i$，这个多项式必须包含因子 $(x-x\_0), (x-x\_1), \\dots, (x-x\_{i-1}), (x-x\_{i+1}), \\dots, (x-x\_n)$。 即 $L\_{n,i}(x) = C \\prod\_{j=0, j \\neq i}^{n} (x-x\_j)$。
*   为了满足 $L\_{n,i}(x\_i)=1$，我们用 $x=x\_i$ 代入来确定常数 $C$： $1 = C \\prod\_{j=0, j \\neq i}^{n} (x\_i-x\_j) \\implies C = \\frac{1}{\\prod\_{j=0, j \\neq i}^{n} (x\_i-x\_j)}$

**拉格朗日基函数公式：** $L\_{n,i}(x) = \\prod\_{j=0, j \\neq i}^{n} \\frac{x-x\_j}{x\_i-x\_j}$

**最终的拉格朗日插值多项式：** $P\_n(x) = \\sum\_{i=0}^n y\_i \\left( \\prod\_{j=0, j \\neq i}^{n} \\frac{x-x\_j}{x\_i-x\_j} \\right)$

**定理 (唯一性):** 对于 $n+1$ 个相异节点，次数**不超过** $n$ 的插值多项式是**唯一**的。

*   **证明思路 (反证法):** 假设存在两个不同的次数 $\\le n$ 的插值多项式 $P\_n(x)$ 和 $Q\_n(x)$。令 $D(x) = P\_n(x) - Q\_n(x)$。$D(x)$ 是一个次数 $\\le n$ 的多项式。但由于 $P\_n(x\_i)=Q\_n(x\_i)=y\_i$，所以 $D(x\_i)=0$ for $i=0, \\dots, n$。这意味着 $D(x)$ 有 $n+1$ 个根。一个次数不超过 $n$ 的非零多项式不可能有 $n+1$ 个根，除非它恒为零多项式。因此 $D(x) \\equiv 0$，即 $P\_n(x) \\equiv Q\_n(x)$。矛盾。

#### **3.1.1 插值误差分析**

我们用 $P\_n(x)$ 近似 $f(x)$，其截断误差为 $R\_n(x) = f(x) - P\_n(x)$。 可以证明（通过巧妙构造辅助函数并反复应用罗尔定理），如果 $f$ 在包含所有插值节点和 $x$ 的区间上具有 $n+1$ 阶连续导数，则插值误差为：

**插值误差公式：** 对于任意 $x$，存在一个依赖于 $x$ 的点 $\\xi\_x$ 在插值节点所在的区间内，使得： $R\_n(x) = f(x) - P\_n(x) = \\frac{f^{(n+1)}(\\xi\_x)}{(n+1)!} \\prod\_{i=0}^n (x-x\_i)$

**误差分析：** 插值误差由三部分决定：

1.  **$f^{(n+1)}(\\xi\_x)$:** 函数的高阶导数。如果函数本身很“平滑”（高阶导数小），则误差小。
2.  $\\frac{1}{(n+1)!}$:阶乘项。随着插值点数 $n$ 的增加，这一项迅速减小。
3.  **$\\prod\_{i=0}^n (x-x\_i)$:** 节点多项式。这一项的大小和震荡行为与**插值节点的分布**密切相关。

**重要结论：**

*   **插值多项式是精确的：** 如果被插函数 $f(x)$ 本身就是一个次数 $\\le n$ 的多项式，那么其 $n+1$ 阶导数恒为零，因此插值误差 $R\_n(x) \\equiv 0$。
*   **误差上界：** 在实际应用中，我们通常不知道 $\\xi\_x$ 的具体位置，但可以找到 $|f^{(n+1)}(t)|$ 在整个区间上的一个上界 $M\_{n+1}$。 $|f(x) - P\_n(x)| \\le \\frac{M\_{n+1}}{(n+1)!} \\left| \\prod\_{i=0}^n (x-x\_i) \\right|$

**Discussion 17: 线性插值步长选择**

*   **问题：** 为 $f(x)=e^x$ 在 $\[0, 1\]$ 上制表，要求使用线性插值（$n=1$）时的绝对误差不超过 $10^{-6}$，应如何选择步长 $h$？
*   **分析：**
    *   线性插值使用两个节点 $x\_k, x\_{k+1}$，其中 $x\_{k+1}-x\_k = h$。
    *   误差公式为 $|f(x)-P\_1(x)| = \\left| \\frac{f^{(2)}(\\xi)}{2!} (x-x\_k)(x-x\_{k+1}) \\right|$。
    *   $f(x)=e^x$, $f''(x)=e^x$。在 $\[0,1\]$ 上，$|f''(\\xi)| \\le e^1 = e$。
    *   函数 $|(x-x\_k)(x-x\_{k+1})|$ 在区间 $\[x\_k, x\_{k+1}\]$ 中点的绝对值最大，为 $h^2/4$。
    *   误差上界为 $\\frac{e}{2} \\cdot \\frac{h^2}{4} = \\frac{e h^2}{8}$。
    *   解不等式 $\\frac{e h^2}{8} \\le 10^{-6}$，得到 $h \\le \\sqrt{\\frac{8 \\times 10^{-6}}{e}} \\approx 1.72 \\times 10^{-3}$。
    *   为了方便，我们可以选择一个更小的、整洁的步长，例如 $h=0.001$ ($n=1000$)。

### **课程总结**

**本讲核心要点：**

1.  **条件数 $K(A)$** 是衡量线性系统对输入扰动敏感性的关键指标。病态系统（$K(A)$ 巨大）即使使用稳定算法也可能得到不可靠的解。
2.  **迭代改善** 是一种利用高精度计算残差来有效修正数值解的方法。
3.  **多项式插值** 是用一个简单的多项式来穿过一系列离散数据点的基本技术，是函数逼近的基石。
4.  **拉格朗日插值多项式** 提供了一种直观的、具有构造性的方法来找到唯一的、次数不超过 $n$ 的插值多项式。
5.  **插值误差** 取决于函数的高阶导数和插值节点的分布，我们可以通过误差公式来估计近似的精度。